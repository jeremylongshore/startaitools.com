<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "1d375ae049e52c89287d533daa4ba348",
  "translation_date": "2025-09-30T23:25:57+00:00",
  "source_file": "11-MCPServerHandsOnLabs/00-Introduction/README.md",
  "language_code": "uk"
}
-->
# Вступ до інтеграції баз даних MCP

## 🎯 Що охоплює цей лабораторний практикум

Цей вступний лабораторний практикум надає всебічний огляд створення серверів Model Context Protocol (MCP) з інтеграцією баз даних. Ви зрозумієте бізнес-кейс, технічну архітектуру та реальні застосування через приклад аналітики Zava Retail за посиланням https://github.com/microsoft/MCP-Server-and-PostgreSQL-Sample-Retail.

## Огляд

**Model Context Protocol (MCP)** дозволяє AI-асистентам безпечно отримувати доступ до зовнішніх джерел даних та взаємодіяти з ними в реальному часі. У поєднанні з інтеграцією баз даних MCP відкриває потужні можливості для застосувань штучного інтелекту, орієнтованих на дані.

Цей навчальний курс навчає створювати сервери MCP, готові до використання у виробництві, які підключають AI-асистентів до даних про роздрібні продажі через PostgreSQL, впроваджуючи корпоративні шаблони, такі як безпека на рівні рядків, семантичний пошук і доступ до даних для кількох орендарів.

## Навчальні цілі

До кінця цього лабораторного практикуму ви зможете:

- **Визначити** Model Context Protocol та його основні переваги для інтеграції баз даних
- **Ідентифікувати** ключові компоненти архітектури сервера MCP з базами даних
- **Зрозуміти** приклад використання Zava Retail та його бізнес-вимоги
- **Розпізнати** корпоративні шаблони для безпечного та масштабованого доступу до баз даних
- **Перерахувати** інструменти та технології, які використовуються протягом цього навчального курсу

## 🧭 Виклик: AI зустрічає реальні дані

### Обмеження традиційного AI

Сучасні AI-асистенти надзвичайно потужні, але стикаються зі значними обмеженнями при роботі з реальними бізнес-даними:

| **Виклик** | **Опис** | **Вплив на бізнес** |
|------------|----------|---------------------|
| **Статичні знання** | Моделі AI, навчені на фіксованих наборах даних, не можуть отримувати доступ до актуальних бізнес-даних | Застарілі інсайти, втрачені можливості |
| **Ізоляція даних** | Інформація заблокована в базах даних, API та системах, до яких AI не має доступу | Неповний аналіз, фрагментовані робочі процеси |
| **Обмеження безпеки** | Прямий доступ до баз даних створює ризики для безпеки та відповідності | Обмежене впровадження, ручна підготовка даних |
| **Складні запити** | Бізнес-користувачам потрібні технічні знання для отримання інсайтів з даних | Знижена прийнятність, неефективні процеси |

### Рішення MCP

Model Context Protocol вирішує ці виклики, забезпечуючи:

- **Доступ до даних у реальному часі**: AI-асистенти виконують запити до живих баз даних та API
- **Безпечну інтеграцію**: Контрольований доступ з аутентифікацією та дозволами
- **Інтерфейс природної мови**: Бізнес-користувачі ставлять запитання звичайною мовою
- **Стандартизований протокол**: Працює з різними платформами та інструментами AI

## 🏪 Знайомтесь із Zava Retail: наш навчальний кейс https://github.com/microsoft/MCP-Server-and-PostgreSQL-Sample-Retail

Протягом цього навчального курсу ми створимо сервер MCP для **Zava Retail**, вигаданої мережі магазинів DIY з кількома локаціями. Цей реалістичний сценарій демонструє впровадження MCP корпоративного рівня.

### Бізнес-контекст

**Zava Retail** управляє:
- **8 фізичними магазинами** у штаті Вашингтон (Сіетл, Белв'ю, Такома, Спокан, Еверетт, Редмонд, Кіркленд)
- **1 онлайн-магазином** для продажів через електронну комерцію
- **Різноманітним каталогом продуктів**, включаючи інструменти, обладнання, садові товари та будівельні матеріали
- **Багаторівневим управлінням** із менеджерами магазинів, регіональними менеджерами та керівниками

### Бізнес-вимоги

Менеджери магазинів та керівники потребують аналітики на основі AI для:

1. **Аналізу ефективності продажів** у магазинах та за періодами часу
2. **Відстеження рівнів запасів** та визначення потреб у поповненні
3. **Розуміння поведінки клієнтів** та моделей покупок
4. **Виявлення інсайтів про продукти** через семантичний пошук
5. **Генерації звітів** за допомогою запитів природною мовою
6. **Забезпечення безпеки даних** через контроль доступу на основі ролей

### Технічні вимоги

Сервер MCP має забезпечувати:

- **Доступ до даних для кількох орендарів**, де менеджери магазинів бачать лише дані свого магазину
- **Гнучке виконання запитів**, що підтримує складні SQL-операції
- **Семантичний пошук** для виявлення продуктів та рекомендацій
- **Дані в реальному часі**, що відображають поточний стан бізнесу
- **Безпечну аутентифікацію** з безпекою на рівні рядків
- **Масштабовану архітектуру**, що підтримує кілька одночасних користувачів

## 🏗️ Огляд архітектури сервера MCP

Наш сервер MCP реалізує багатошарову архітектуру, оптимізовану для інтеграції баз даних:

```
┌─────────────────────────────────────────────────────────────┐
│                    VS Code AI Client                       │
│                  (Natural Language Queries)                │
└─────────────────────┬───────────────────────────────────────┘
                      │ HTTP/SSE
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                     MCP Server                             │
│  ┌─────────────────┐ ┌─────────────────┐ ┌───────────────┐ │
│  │   Tool Layer    │ │  Security Layer │ │  Config Layer │ │
│  │                 │ │                 │ │               │ │
│  │ • Query Tools   │ │ • RLS Context   │ │ • Environment │ │
│  │ • Schema Tools  │ │ • User Identity │ │ • Connections │ │
│  │ • Search Tools  │ │ • Access Control│ │ • Validation  │ │
│  └─────────────────┘ └─────────────────┘ └───────────────┘ │
└─────────────────────┬───────────────────────────────────────┘
                      │ asyncpg
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                PostgreSQL Database                         │
│  ┌─────────────────┐ ┌─────────────────┐ ┌───────────────┐ │
│  │  Retail Schema  │ │   RLS Policies  │ │   pgvector    │ │
│  │                 │ │                 │ │               │ │
│  │ • Stores        │ │ • Store-based   │ │ • Embeddings  │ │
│  │ • Customers     │ │   Isolation     │ │ • Similarity  │ │
│  │ • Products      │ │ • Role Control  │ │   Search      │ │
│  │ • Orders        │ │ • Audit Logs    │ │               │ │
│  └─────────────────┘ └─────────────────┘ └───────────────┘ │
└─────────────────────┬───────────────────────────────────────┘
                      │ REST API
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                  Azure OpenAI                              │
│               (Text Embeddings)                            │
└─────────────────────────────────────────────────────────────┘
```

### Ключові компоненти

#### **1. Шар сервера MCP**
- **FastMCP Framework**: Сучасна реалізація сервера MCP на Python
- **Реєстрація інструментів**: Декларативні визначення інструментів із перевіркою типів
- **Контекст запиту**: Управління ідентичністю користувача та сесіями
- **Обробка помилок**: Надійне управління помилками та логування

#### **2. Шар інтеграції баз даних**
- **Пул підключень**: Ефективне управління підключеннями asyncpg
- **Постачальник схем**: Динамічне виявлення схем таблиць
- **Виконавець запитів**: Безпечне виконання SQL із контекстом RLS
- **Управління транзакціями**: Відповідність ACID та обробка відкатів

#### **3. Шар безпеки**
- **Безпека на рівні рядків**: PostgreSQL RLS для ізоляції даних кількох орендарів
- **Ідентичність користувача**: Аутентифікація та авторизація менеджерів магазинів
- **Контроль доступу**: Тонко налаштовані дозволи та журнали аудиту
- **Валідація введення**: Запобігання SQL-ін'єкціям та перевірка запитів

#### **4. Шар покращення AI**
- **Семантичний пошук**: Векторні вбудовування для виявлення продуктів
- **Інтеграція Azure OpenAI**: Генерація текстових вбудовувань
- **Алгоритми схожості**: Пошук косинусної схожості pgvector
- **Оптимізація пошуку**: Індексація та налаштування продуктивності

## 🔧 Технологічний стек

### Основні технології

| **Компонент** | **Технологія** | **Призначення** |
|---------------|----------------|-----------------|
| **Фреймворк MCP** | FastMCP (Python) | Сучасна реалізація сервера MCP |
| **База даних** | PostgreSQL 17 + pgvector | Реляційні дані з пошуком за векторами |
| **Сервіси AI** | Azure OpenAI | Текстові вбудовування та мовні моделі |
| **Контейнеризація** | Docker + Docker Compose | Середовище розробки |
| **Хмарна платформа** | Microsoft Azure | Розгортання у виробництві |
| **Інтеграція IDE** | VS Code | AI Chat та робочий процес розробки |

### Інструменти розробки

| **Інструмент** | **Призначення** |
|----------------|-----------------|
| **asyncpg** | Високопродуктивний драйвер PostgreSQL |
| **Pydantic** | Валідація даних та серіалізація |
| **Azure SDK** | Інтеграція хмарних сервісів |
| **pytest** | Фреймворк для тестування |
| **Docker** | Контейнеризація та розгортання |

### Виробничий стек

| **Сервіс** | **Ресурс Azure** | **Призначення** |
|------------|------------------|-----------------|
| **База даних** | Azure Database for PostgreSQL | Керований сервіс баз даних |
| **Контейнер** | Azure Container Apps | Хостинг безсерверних контейнерів |
| **Сервіси AI** | Azure AI Foundry | Моделі OpenAI та кінцеві точки |
| **Моніторинг** | Application Insights | Спостереження та діагностика |
| **Безпека** | Azure Key Vault | Управління секретами та конфігурацією |

## 🎬 Реальні сценарії використання

Давайте розглянемо, як різні користувачі взаємодіють із нашим сервером MCP:

### Сценарій 1: Огляд ефективності менеджера магазину

**Користувач**: Сара, менеджер магазину в Сіетлі  
**Мета**: Аналіз ефективності продажів за останній квартал

**Запит природною мовою**:
> "Покажіть мені топ-10 продуктів за доходом для мого магазину у 4 кварталі 2024 року"

**Що відбувається**:
1. AI Chat у VS Code надсилає запит до сервера MCP
2. Сервер MCP визначає контекст магазину Сари (Сіетл)
3. Політики RLS фільтрують дані лише для магазину в Сіетлі
4. Генерується та виконується SQL-запит
5. Результати форматуються та повертаються до AI Chat
6. AI надає аналіз та інсайти

### Сценарій 2: Виявлення продуктів через семантичний пошук

**Користувач**: Майк, менеджер з інвентаризації  
**Мета**: Знайти продукти, схожі на запит клієнта

**Запит природною мовою**:
> "Які продукти ми продаємо, схожі на 'водонепроникні електричні з'єднувачі для зовнішнього використання'?"

**Що відбувається**:
1. Запит обробляється інструментом семантичного пошуку
2. Azure OpenAI генерує векторне вбудовування
3. pgvector виконує пошук за схожістю
4. Схожі продукти ранжуються за релевантністю
5. Результати включають деталі продуктів та їх доступність
6. AI пропонує альтернативи та можливості для комплектування

### Сценарій 3: Аналітика між магазинами

**Користувач**: Дженніфер, регіональний менеджер  
**Мета**: Порівняти ефективність продажів між усіма магазинами

**Запит природною мовою**:
> "Порівняйте продажі за категоріями для всіх магазинів за останні 6 місяців"

**Що відбувається**:
1. Контекст RLS встановлюється для доступу регіонального менеджера
2. Генерується складний запит для кількох магазинів
3. Дані агрегуються між локаціями магазинів
4. Результати включають тренди та порівняння
5. AI визначає інсайти та рекомендації

## 🔒 Глибокий аналіз безпеки та мультиорендарності

Наша реалізація пріоритетно забезпечує безпеку корпоративного рівня:

### Безпека на рівні рядків (RLS)

PostgreSQL RLS забезпечує ізоляцію даних:

```sql
-- Store managers see only their store's data
CREATE POLICY store_manager_policy ON retail.orders
  FOR ALL TO store_managers
  USING (store_id = get_current_user_store());

-- Regional managers see multiple stores
CREATE POLICY regional_manager_policy ON retail.orders
  FOR ALL TO regional_managers
  USING (store_id = ANY(get_user_store_list()));
```

### Управління ідентичністю користувачів

Кожне підключення MCP включає:
- **ID менеджера магазину**: Унікальний ідентифікатор для контексту RLS
- **Призначення ролей**: Дозволи та рівні доступу
- **Управління сесіями**: Безпечні токени аутентифікації
- **Журнал аудиту**: Повна історія доступу

### Захист даних

Кілька рівнів безпеки:
- **Шифрування підключень**: TLS для всіх підключень до баз даних
- **Запобігання SQL-ін'єкціям**: Виключно параметризовані запити
- **Валідація введення**: Комплексна перевірка запитів
- **Обробка помилок**: Відсутність конфіденційних даних у повідомленнях про помилки

## 🎯 Основні висновки

Після завершення цього вступу ви повинні зрозуміти:

✅ **Цінність MCP**: Як MCP з'єднує AI-асистентів із реальними даними  
✅ **Бізнес-контекст**: Вимоги та виклики Zava Retail  
✅ **Огляд архітектури**: Ключові компоненти та їх взаємодія  
✅ **Технологічний стек**: Інструменти та фреймворки, які використовуються  
✅ **Модель безпеки**: Доступ до даних для кількох орендарів та їх захист  
✅ **Шаблони використання**: Реальні сценарії запитів та робочі процеси  

## 🚀 Що далі

Готові заглибитися? Продовжуйте з:

**[Лабораторія 01: Основні концепції архітектури](../01-Architecture/README.md)**

Дізнайтеся про шаблони архітектури серверів MCP, принципи дизайну баз даних та детальну технічну реалізацію, яка забезпечує нашу аналітичну роздрібну платформу.

## 📚 Додаткові ресурси

### Документація MCP
- [Специфікація MCP](https://modelcontextprotocol.io/docs/) - Офіційна документація протоколу
- [MCP для початківців](https://aka.ms/mcp-for-beginners) - Комплексний навчальний посібник MCP
- [Документація FastMCP](https://github.com/modelcontextprotocol/python-sdk) - Документація Python SDK

### Інтеграція баз даних
- [Документація PostgreSQL](https://www.postgresql.org/docs/) - Повний довідник PostgreSQL
- [Посібник pgvector](https://github.com/pgvector/pgvector) - Документація розширення для векторів
- [Безпека на рівні рядків](https://www.postgresql.org/docs/current/ddl-rowsecurity.html) - Посібник PostgreSQL RLS

### Сервіси Azure
- [Документація Azure OpenAI](https://docs.microsoft.com/azure/cognitive-services/openai/) - Інтеграція сервісів AI
- [Azure Database for PostgreSQL](https://docs.microsoft.com/azure/postgresql/) - Керований сервіс баз даних
- [Azure Container Apps](https://docs.microsoft.com/azure/container-apps/) - Безсерверні контейнери

---

**Застереження**: Це навчальна вправа з використанням вигаданих роздрібних даних. Завжди дотримуйтесь політик управління даними та безпеки вашої організації при впровадженні подібних рішень у виробничих середовищах.

---

**Відмова від відповідальності**:  
Цей документ був перекладений за допомогою сервісу автоматичного перекладу [Co-op Translator](https://github.com/Azure/co-op-translator). Хоча ми прагнемо до точності, будь ласка, майте на увазі, що автоматичні переклади можуть містити помилки або неточності. Оригінальний документ на його рідній мові слід вважати авторитетним джерелом. Для критичної інформації рекомендується професійний людський переклад. Ми не несемо відповідальності за будь-які непорозуміння або неправильні тлумачення, що виникають внаслідок використання цього перекладу.