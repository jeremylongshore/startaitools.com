<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "98bcd044860716da5819e31c152813b7",
  "translation_date": "2025-08-18T14:33:41+00:00",
  "source_file": "03-GettingStarted/07-aitk/README.md",
  "language_code": "th"
}
-->
# การใช้งานเซิร์ฟเวอร์จากส่วนขยาย AI Toolkit สำหรับ Visual Studio Code

เมื่อคุณสร้าง AI agent มันไม่ได้เกี่ยวกับการสร้างคำตอบที่ฉลาดเท่านั้น แต่ยังเกี่ยวกับการให้ agent ของคุณสามารถดำเนินการได้ด้วย นี่คือจุดที่ Model Context Protocol (MCP) เข้ามามีบทบาท MCP ทำให้ agent สามารถเข้าถึงเครื่องมือและบริการภายนอกได้อย่างง่ายดายในรูปแบบที่สอดคล้องกัน ลองนึกภาพเหมือนการเสียบ agent ของคุณเข้ากับกล่องเครื่องมือที่มันสามารถ *ใช้งานได้จริง*

สมมติว่าคุณเชื่อมต่อ agent กับเซิร์ฟเวอร์ MCP เครื่องคิดเลข ทันใดนั้น agent ของคุณสามารถทำการคำนวณทางคณิตศาสตร์ได้เพียงแค่รับคำสั่ง เช่น “47 คูณ 89 เท่ากับเท่าไหร่?”—ไม่จำเป็นต้องเขียนโค้ดตรรกะหรือสร้าง API เฉพาะทาง

## ภาพรวม

บทเรียนนี้ครอบคลุมวิธีการเชื่อมต่อเซิร์ฟเวอร์ MCP เครื่องคิดเลขกับ agent โดยใช้ส่วนขยาย [AI Toolkit](https://aka.ms/AIToolkit) ใน Visual Studio Code ซึ่งช่วยให้ agent ของคุณสามารถทำการคำนวณ เช่น การบวก การลบ การคูณ และการหาร ผ่านภาษาธรรมชาติ

AI Toolkit เป็นส่วนขยายที่ทรงพลังสำหรับ Visual Studio Code ที่ช่วยให้การพัฒนา agent เป็นไปอย่างง่ายดาย วิศวกร AI สามารถสร้างแอปพลิเคชัน AI ได้โดยการพัฒนาและทดสอบโมเดล AI เชิงสร้างสรรค์—ทั้งในเครื่องหรือในคลาวด์ ส่วนขยายนี้รองรับโมเดลเชิงสร้างสรรค์หลัก ๆ ที่มีอยู่ในปัจจุบัน

*หมายเหตุ*: AI Toolkit รองรับ Python และ TypeScript ในปัจจุบัน

## วัตถุประสงค์การเรียนรู้

เมื่อจบบทเรียนนี้ คุณจะสามารถ:

- ใช้งานเซิร์ฟเวอร์ MCP ผ่าน AI Toolkit
- กำหนดค่าการตั้งค่า agent เพื่อให้สามารถค้นหาและใช้เครื่องมือที่เซิร์ฟเวอร์ MCP ให้บริการ
- ใช้เครื่องมือ MCP ผ่านภาษาธรรมชาติ

## วิธีการ

นี่คือวิธีการที่เราต้องดำเนินการในภาพรวม:

- สร้าง agent และกำหนด system prompt
- สร้างเซิร์ฟเวอร์ MCP พร้อมเครื่องมือเครื่องคิดเลข
- เชื่อมต่อ Agent Builder กับเซิร์ฟเวอร์ MCP
- ทดสอบการเรียกใช้เครื่องมือของ agent ผ่านภาษาธรรมชาติ

เยี่ยมเลย ตอนนี้เราเข้าใจขั้นตอนแล้ว มาเริ่มกำหนดค่า AI agent เพื่อใช้เครื่องมือภายนอกผ่าน MCP เพื่อเพิ่มความสามารถกันเถอะ!

## สิ่งที่ต้องเตรียม

- [Visual Studio Code](https://code.visualstudio.com/)
- [AI Toolkit สำหรับ Visual Studio Code](https://aka.ms/AIToolkit)

## แบบฝึกหัด: การใช้งานเซิร์ฟเวอร์

> [!WARNING]
> หมายเหตุสำหรับผู้ใช้ macOS ขณะนี้เรากำลังตรวจสอบปัญหาที่ส่งผลต่อการติดตั้ง dependency บน macOS ดังนั้นผู้ใช้ macOS จะไม่สามารถทำแบบฝึกหัดนี้ได้ในขณะนี้ เราจะอัปเดตคำแนะนำทันทีที่มีการแก้ไข ขอขอบคุณสำหรับความอดทนและความเข้าใจ!

ในแบบฝึกหัดนี้ คุณจะสร้าง agent และปรับปรุง agent ด้วยเครื่องมือจากเซิร์ฟเวอร์ MCP ภายใน Visual Studio Code โดยใช้ AI Toolkit

### -0- ขั้นตอนเตรียมการ เพิ่มโมเดล OpenAI GPT-4o ไปยัง My Models

แบบฝึกหัดนี้ใช้โมเดล **GPT-4o** โมเดลนี้ควรถูกเพิ่มไปยัง **My Models** ก่อนที่จะสร้าง agent

1. เปิดส่วนขยาย **AI Toolkit** จาก **Activity Bar**
1. ในส่วน **Catalog** เลือก **Models** เพื่อเปิด **Model Catalog** การเลือก **Models** จะเปิด **Model Catalog** ในแท็บตัวแก้ไขใหม่
1. ในแถบค้นหา **Model Catalog** ให้ป้อน **OpenAI GPT-4o**
1. คลิก **+ Add** เพื่อเพิ่มโมเดลไปยังรายการ **My Models** ของคุณ ตรวจสอบให้แน่ใจว่าคุณเลือกโมเดลที่ **Hosted by GitHub**
1. ใน **Activity Bar** ยืนยันว่าโมเดล **OpenAI GPT-4o** ปรากฏในรายการ

### -1- สร้าง agent

**Agent (Prompt) Builder** ช่วยให้คุณสร้างและปรับแต่ง agent ที่ขับเคลื่อนด้วย AI ของคุณเอง ในส่วนนี้ คุณจะสร้าง agent ใหม่และกำหนดโมเดลเพื่อขับเคลื่อนการสนทนา

1. เปิดส่วนขยาย **AI Toolkit** จาก **Activity Bar**
1. ในส่วน **Tools** เลือก **Agent (Prompt) Builder** การเลือก **Agent (Prompt) Builder** จะเปิด **Agent (Prompt) Builder** ในแท็บตัวแก้ไขใหม่
1. คลิกปุ่ม **+ New Agent** ส่วนขยายจะเปิดตัวช่วยตั้งค่าผ่าน **Command Palette**
1. ป้อนชื่อ **Calculator Agent** และกด **Enter**
1. ใน **Agent (Prompt) Builder** สำหรับฟิลด์ **Model** เลือกโมเดล **OpenAI GPT-4o (via GitHub)**

### -2- สร้าง system prompt สำหรับ agent

เมื่อสร้างโครงสร้าง agent แล้ว ก็ถึงเวลากำหนดบุคลิกและวัตถุประสงค์ของมัน ในส่วนนี้ คุณจะใช้ฟีเจอร์ **Generate system prompt** เพื่ออธิบายพฤติกรรมที่ตั้งใจของ agent—ในกรณีนี้คือ agent เครื่องคิดเลข—และให้โมเดลเขียน system prompt ให้คุณ

1. สำหรับส่วน **Prompts** คลิกปุ่ม **Generate system prompt** ปุ่มนี้จะเปิดตัวสร้าง prompt ซึ่งใช้ AI ในการสร้าง system prompt สำหรับ agent
1. ในหน้าต่าง **Generate a prompt** ป้อนข้อความต่อไปนี้: `คุณเป็นผู้ช่วยคณิตศาสตร์ที่มีประสิทธิภาพและช่วยเหลือดี เมื่อได้รับปัญหาที่เกี่ยวข้องกับการคำนวณพื้นฐาน คุณจะตอบกลับด้วยผลลัพธ์ที่ถูกต้อง`
1. คลิกปุ่ม **Generate** การแจ้งเตือนจะปรากฏที่มุมล่างขวาเพื่อยืนยันว่ากำลังสร้าง system prompt เมื่อการสร้าง prompt เสร็จสิ้น prompt จะปรากฏในฟิลด์ **System prompt** ของ **Agent (Prompt) Builder**
1. ตรวจสอบ **System prompt** และปรับแก้หากจำเป็น

### -3- สร้างเซิร์ฟเวอร์ MCP

เมื่อคุณกำหนด system prompt ของ agent แล้ว—ซึ่งเป็นการชี้นำพฤติกรรมและการตอบกลับของมัน—ก็ถึงเวลาติดตั้งความสามารถที่ใช้งานได้จริง ในส่วนนี้ คุณจะสร้างเซิร์ฟเวอร์ MCP เครื่องคิดเลขพร้อมเครื่องมือสำหรับการคำนวณ เช่น การบวก การลบ การคูณ และการหาร เซิร์ฟเวอร์นี้จะช่วยให้ agent ของคุณสามารถดำเนินการคำนวณแบบเรียลไทม์เพื่อตอบสนองต่อคำสั่งภาษาธรรมชาติ

AI Toolkit มีเทมเพลตเพื่อความสะดวกในการสร้างเซิร์ฟเวอร์ MCP ของคุณเอง เราจะใช้เทมเพลต Python สำหรับการสร้างเซิร์ฟเวอร์ MCP เครื่องคิดเลข

*หมายเหตุ*: AI Toolkit รองรับ Python และ TypeScript ในปัจจุบัน

1. ในส่วน **Tools** ของ **Agent (Prompt) Builder** คลิกปุ่ม **+ MCP Server** ส่วนขยายจะเปิดตัวช่วยตั้งค่าผ่าน **Command Palette**
1. เลือก **+ Add Server**
1. เลือก **Create a New MCP Server**
1. เลือก **python-weather** เป็นเทมเพลต
1. เลือก **Default folder** เพื่อบันทึกเทมเพลตเซิร์ฟเวอร์ MCP
1. ป้อนชื่อเซิร์ฟเวอร์ดังนี้: **Calculator**
1. หน้าต่าง Visual Studio Code ใหม่จะเปิดขึ้น เลือก **Yes, I trust the authors**
1. ใช้ terminal (**Terminal** > **New Terminal**) สร้าง virtual environment: `python -m venv .venv`
1. ใช้ terminal เปิดใช้งาน virtual environment:
    1. Windows - `.venv\Scripts\activate`
    1. macOS/Linux - `source .venv/bin/activate`
1. ใช้ terminal ติดตั้ง dependencies: `pip install -e .[dev]`
1. ใน **Explorer** view ของ **Activity Bar** ขยายไดเรกทอรี **src** และเลือก **server.py** เพื่อเปิดไฟล์ในตัวแก้ไข
1. แทนที่โค้ดในไฟล์ **server.py** ด้วยโค้ดต่อไปนี้และบันทึก:

    ```python
    """
    Sample MCP Calculator Server implementation in Python.

    
    This module demonstrates how to create a simple MCP server with calculator tools
    that can perform basic arithmetic operations (add, subtract, multiply, divide).
    """
    
    from mcp.server.fastmcp import FastMCP
    
    server = FastMCP("calculator")
    
    @server.tool()
    def add(a: float, b: float) -> float:
        """Add two numbers together and return the result."""
        return a + b
    
    @server.tool()
    def subtract(a: float, b: float) -> float:
        """Subtract b from a and return the result."""
        return a - b
    
    @server.tool()
    def multiply(a: float, b: float) -> float:
        """Multiply two numbers together and return the result."""
        return a * b
    
    @server.tool()
    def divide(a: float, b: float) -> float:
        """
        Divide a by b and return the result.
        
        Raises:
            ValueError: If b is zero
        """
        if b == 0:
            raise ValueError("Cannot divide by zero")
        return a / b
    ```

### -4- รัน agent พร้อมเซิร์ฟเวอร์ MCP เครื่องคิดเลข

เมื่อ agent ของคุณมีเครื่องมือแล้ว ก็ถึงเวลาทดสอบ! ในส่วนนี้ คุณจะส่งคำสั่งไปยัง agent เพื่อทดสอบและตรวจสอบว่า agent ใช้เครื่องมือที่เหมาะสมจากเซิร์ฟเวอร์ MCP เครื่องคิดเลข

1. กด `F5` เพื่อเริ่มการดีบักเซิร์ฟเวอร์ MCP **Agent (Prompt) Builder** จะเปิดในแท็บตัวแก้ไขใหม่ สถานะของเซิร์ฟเวอร์จะปรากฏใน terminal
1. ในฟิลด์ **User prompt** ของ **Agent (Prompt) Builder** ป้อนคำสั่งต่อไปนี้: `ฉันซื้อของ 3 ชิ้น ราคา $25 ต่อชิ้น และใช้ส่วนลด $20 ฉันจ่ายเงินเท่าไหร่?`
1. คลิกปุ่ม **Run** เพื่อสร้างการตอบกลับของ agent
1. ตรวจสอบผลลัพธ์ของ agent โมเดลควรสรุปว่าคุณจ่ายเงิน **$55**
1. นี่คือการทำงานที่ควรเกิดขึ้น:
    - agent เลือกเครื่องมือ **multiply** และ **subtract** เพื่อช่วยในการคำนวณ
    - ค่า `a` และ `b` ที่เหมาะสมถูกกำหนดให้กับเครื่องมือ **multiply**
    - ค่า `a` และ `b` ที่เหมาะสมถูกกำหนดให้กับเครื่องมือ **subtract**
    - การตอบกลับจากแต่ละเครื่องมือจะปรากฏใน **Tool Response**
    - ผลลัพธ์สุดท้ายจากโมเดลจะปรากฏใน **Model Response**
1. ส่งคำสั่งเพิ่มเติมเพื่อทดสอบ agent คุณสามารถแก้ไขคำสั่งที่มีอยู่ในฟิลด์ **User prompt** โดยคลิกเข้าไปในฟิลด์และแทนที่คำสั่งที่มีอยู่
1. เมื่อคุณทดสอบ agent เสร็จแล้ว คุณสามารถหยุดเซิร์ฟเวอร์ผ่าน **terminal** โดยป้อน **CTRL/CMD+C** เพื่อออก

## งานที่ได้รับมอบหมาย

ลองเพิ่มเครื่องมือใหม่ในไฟล์ **server.py** ของคุณ (เช่น การคืนค่ารากที่สองของตัวเลข) ส่งคำสั่งเพิ่มเติมที่จำเป็นต้องใช้เครื่องมือใหม่ของคุณ (หรือเครื่องมือที่มีอยู่) อย่าลืมรีสตาร์ทเซิร์ฟเวอร์เพื่อโหลดเครื่องมือที่เพิ่มใหม่

## วิธีแก้ไข

[Solution](./solution/README.md)

## สิ่งสำคัญที่ควรทราบ

สิ่งที่ควรทราบจากบทนี้คือ:

- ส่วนขยาย AI Toolkit เป็น client ที่ยอดเยี่ยมที่ช่วยให้คุณใช้งานเซิร์ฟเวอร์ MCP และเครื่องมือของมัน
- คุณสามารถเพิ่มเครื่องมือใหม่ในเซิร์ฟเวอร์ MCP เพื่อขยายความสามารถของ agent ให้ตอบสนองความต้องการที่เปลี่ยนแปลง
- AI Toolkit มีเทมเพลต (เช่น เทมเพลตเซิร์ฟเวอร์ MCP Python) เพื่อทำให้การสร้างเครื่องมือเฉพาะง่ายขึ้น

## แหล่งข้อมูลเพิ่มเติม

- [เอกสาร AI Toolkit](https://aka.ms/AIToolkit/doc)

## สิ่งที่จะทำต่อไป
- ถัดไป: [การทดสอบและการดีบัก](../08-testing/README.md)

**ข้อจำกัดความรับผิดชอบ**:  
เอกสารนี้ได้รับการแปลโดยใช้บริการแปลภาษา AI [Co-op Translator](https://github.com/Azure/co-op-translator) แม้ว่าเราจะพยายามให้การแปลมีความถูกต้อง แต่โปรดทราบว่าการแปลอัตโนมัติอาจมีข้อผิดพลาดหรือความไม่แม่นยำ เอกสารต้นฉบับในภาษาต้นทางควรถือเป็นแหล่งข้อมูลที่เชื่อถือได้ สำหรับข้อมูลที่สำคัญ ขอแนะนำให้ใช้บริการแปลภาษามนุษย์ที่เป็นมืออาชีพ เราจะไม่รับผิดชอบต่อความเข้าใจผิดหรือการตีความที่ผิดพลาดซึ่งเกิดจากการใช้การแปลนี้