<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "b2b9e15e78b9d9a2b3ff3e8fd7d1f434",
  "translation_date": "2025-08-18T21:13:46+00:00",
  "source_file": "02-Security/mcp-best-practices.md",
  "language_code": "bg"
}
-->
# Най-добри практики за сигурност на MCP 2025

Това изчерпателно ръководство очертава основните практики за сигурност при внедряване на системи с Model Context Protocol (MCP), базирани на най-новата **MCP Спецификация 2025-06-18** и актуалните индустриални стандарти. Тези практики адресират както традиционни проблеми със сигурността, така и специфични за AI заплахи, уникални за MCP внедрения.

## Критични изисквания за сигурност

### Задължителни мерки за сигурност (MUST изисквания)

1. **Валидиране на токени**: MCP сървърите **НЕ ТРЯБВА** да приемат токени, които не са изрично издадени за самия MCP сървър.
2. **Проверка на авторизация**: MCP сървърите, които прилагат авторизация, **ТРЯБВА** да проверяват ВСИЧКИ входящи заявки и **НЕ ТРЯБВА** да използват сесии за автентикация.
3. **Потребителско съгласие**: MCP прокси сървърите, използващи статични клиентски идентификатори, **ТРЯБВА** да получат изрично съгласие от потребителя за всеки динамично регистриран клиент.
4. **Сигурни идентификатори на сесии**: MCP сървърите **ТРЯБВА** да използват криптографски сигурни, недетерминистични идентификатори на сесии, генерирани със сигурни генератори на случайни числа.

## Основни практики за сигурност

### 1. Валидация и пречистване на входни данни
- **Цялостна валидация на входни данни**: Валидирайте и пречиствайте всички входни данни, за да предотвратите атаки чрез инжектиране, проблеми с объркан заместник и уязвимости от тип "prompt injection".
- **Приложение на параметрични схеми**: Прилагайте строга JSON схема за валидация на всички параметри на инструменти и входни данни за API.
- **Филтриране на съдържание**: Използвайте Microsoft Prompt Shields и Azure Content Safety за филтриране на злонамерено съдържание в подсказки и отговори.
- **Пречистване на изходни данни**: Валидирайте и пречиствайте всички изходни данни от модела преди представянето им на потребители или системи надолу по веригата.

### 2. Отлична автентикация и авторизация  
- **Външни доставчици на идентичност**: Делегирайте автентикацията на утвърдени доставчици на идентичност (Microsoft Entra ID, OAuth 2.1 доставчици), вместо да внедрявате персонализирана автентикация.
- **Фино настроени разрешения**: Прилагайте детайлни, специфични за инструменти разрешения, следвайки принципа на минималните привилегии.
- **Управление на жизнения цикъл на токени**: Използвайте краткотрайни токени за достъп със сигурна ротация и правилна валидация на аудиторията.
- **Многофакторна автентикация**: Изисквайте MFA за целия административен достъп и чувствителни операции.

### 3. Сигурни комуникационни протоколи
- **Сигурност на транспортния слой**: Използвайте HTTPS/TLS 1.3 за всички MCP комуникации с правилна валидация на сертификати.
- **Крайно-крайно криптиране**: Прилагайте допълнителни слоеве криптиране за силно чувствителни данни в транзит и в покой.
- **Управление на сертификати**: Поддържайте правилен жизнен цикъл на сертификати с автоматизирани процеси за подновяване.
- **Приложение на версия на протокола**: Използвайте текущата версия на MCP протокола (2025-06-18) с правилна преговорна процедура за версията.

### 4. Разширено ограничаване на скоростта и защита на ресурси
- **Многостепенно ограничаване на скоростта**: Прилагайте ограничаване на скоростта на ниво потребител, сесия, инструмент и ресурс, за да предотвратите злоупотреби.
- **Адаптивно ограничаване на скоростта**: Използвайте ограничаване на скоростта, базирано на машинно обучение, което се адаптира към модели на употреба и индикатори за заплахи.
- **Управление на квоти за ресурси**: Задайте подходящи лимити за изчислителни ресурси, използване на памет и време за изпълнение.
- **Защита от DDoS**: Внедрете цялостна защита от DDoS и системи за анализ на трафика.

### 5. Цялостно логване и мониторинг
- **Структурирано логване за одит**: Прилагайте подробни, търсими логове за всички MCP операции, изпълнения на инструменти и събития за сигурност.
- **Мониторинг на сигурността в реално време**: Внедрете SIEM системи с AI-базирано откриване на аномалии за MCP натоварвания.
- **Логване, съобразено с поверителността**: Логвайте събития за сигурност, като същевременно спазвате изискванията за поверителност на данните и регулациите.
- **Интеграция на реакция при инциденти**: Свържете системите за логване с автоматизирани работни потоци за реакция при инциденти.

### 6. Подобрени практики за сигурно съхранение
- **Модули за хардуерна сигурност**: Използвайте HSM-базирано съхранение на ключове (Azure Key Vault, AWS CloudHSM) за критични криптографски операции.
- **Управление на криптографски ключове**: Прилагайте правилна ротация, сегрегация и контрол на достъпа за криптографски ключове.
- **Управление на тайни**: Съхранявайте всички API ключове, токени и идентификационни данни в специализирани системи за управление на тайни.
- **Класификация на данни**: Класифицирайте данните според нивата на чувствителност и прилагайте подходящи мерки за защита.

### 7. Разширено управление на токени
- **Предотвратяване на предаване на токени**: Изрично забранете модели на предаване на токени, които заобикалят мерките за сигурност.
- **Валидация на аудиторията**: Винаги проверявайте твърденията за аудиторията на токените, за да съответстват на идентичността на MCP сървъра.
- **Авторизация, базирана на твърдения**: Прилагайте детайлна авторизация, базирана на твърденията на токените и атрибутите на потребителите.
- **Обвързване на токени**: Обвързвайте токените със специфични сесии, потребители или устройства, когато е подходящо.

### 8. Сигурно управление на сесии
- **Криптографски идентификатори на сесии**: Генерирайте идентификатори на сесии, използвайки криптографски сигурни генератори на случайни числа (не предсказуеми последователности).
- **Обвързване с потребителска информация**: Обвързвайте идентификаторите на сесии с потребителска информация, използвайки сигурни формати като `<user_id>:<session_id>`.
- **Контроли на жизнения цикъл на сесии**: Прилагайте правилно изтичане, ротация и механизми за анулиране на сесии.
- **Сигурни заглавия за сесии**: Използвайте подходящи HTTP заглавия за защита на сесиите.

### 9. Специфични за AI мерки за сигурност
- **Защита от инжектиране в подсказки**: Внедрете Microsoft Prompt Shields с техники като осветяване, разделители и маркиране на данни.
- **Предотвратяване на отравяне на инструменти**: Валидирайте метаданните на инструментите, следете за динамични промени и проверявайте тяхната цялост.
- **Валидация на изходни данни от модела**: Сканирайте изходните данни от модела за потенциално изтичане на данни, вредно съдържание или нарушения на политиките за сигурност.
- **Защита на контекстния прозорец**: Прилагайте контроли за предотвратяване на отравяне и манипулация на контекстния прозорец.

### 10. Сигурност при изпълнение на инструменти
- **Изолиране на изпълнението**: Изпълнявайте инструментите в контейнеризирани, изолирани среди с ограничения на ресурсите.
- **Разделяне на привилегии**: Изпълнявайте инструментите с минимално необходимите привилегии и отделни служебни акаунти.
- **Мрежова изолация**: Прилагайте сегментация на мрежата за среди за изпълнение на инструменти.
- **Мониторинг на изпълнението**: Следете изпълнението на инструментите за аномално поведение, използване на ресурси и нарушения на сигурността.

### 11. Непрекъсната валидация на сигурността
- **Автоматизирано тестване на сигурността**: Интегрирайте тестване на сигурността в CI/CD процесите с инструменти като GitHub Advanced Security.
- **Управление на уязвимости**: Редовно сканирайте всички зависимости, включително AI модели и външни услуги.
- **Тестове за проникване**: Провеждайте редовни оценки на сигурността, насочени специално към MCP внедрения.
- **Прегледи на код за сигурност**: Внедрете задължителни прегледи на сигурността за всички промени в MCP свързания код.

### 12. Сигурност на веригата за доставки за AI
- **Проверка на компоненти**: Проверявайте произхода, цялостта и сигурността на всички AI компоненти (модели, вграждания, API).
- **Управление на зависимости**: Поддържайте актуални инвентаризации на всички софтуерни и AI зависимости с проследяване на уязвимости.
- **Доверени хранилища**: Използвайте проверени, надеждни източници за всички AI модели, библиотеки и инструменти.
- **Мониторинг на веригата за доставки**: Непрекъснато следете за компромиси в доставчиците на AI услуги и хранилищата на модели.

## Разширени модели за сигурност

### Архитектура на Zero Trust за MCP
- **Никога не се доверявайте, винаги проверявайте**: Прилагайте непрекъсната проверка за всички участници в MCP.
- **Микросегментация**: Изолирайте MCP компонентите с детайлни мрежови и идентичностни контроли.
- **Условен достъп**: Прилагайте контроли за достъп, базирани на риск, които се адаптират към контекста и поведението.
- **Непрекъсната оценка на риска**: Динамично оценявайте сигурността въз основа на текущите индикатори за заплахи.

### Внедряване на AI с опазване на поверителността
- **Минимизиране на данни**: Излагайте само минимално необходимите данни за всяка MCP операция.
- **Диференциална поверителност**: Прилагайте техники за опазване на поверителността при обработка на чувствителни данни.
- **Хомоморфно криптиране**: Използвайте усъвършенствани техники за криптиране за сигурни изчисления върху криптирани данни.
- **Федеративно обучение**: Внедрете разпределени подходи за обучение, които запазват локалността и поверителността на данните.

### Реакция при инциденти за AI системи
- **Процедури за инциденти, специфични за AI**: Разработете процедури за реакция при инциденти, насочени към специфични за AI и MCP заплахи.
- **Автоматизирана реакция**: Внедрете автоматизирано ограничаване и възстановяване за често срещани инциденти със сигурността на AI.
- **Форензични способности**: Поддържайте готовност за форензичен анализ при компромиси на AI системи и изтичане на данни.
- **Процедури за възстановяване**: Установете процедури за възстановяване от отравяне на AI модели, атаки чрез инжектиране в подсказки и компромиси на услуги.

## Ресурси за внедряване и стандарти

### Официална документация за MCP
- [MCP Спецификация 2025-06-18](https://spec.modelcontextprotocol.io/specification/2025-06-18/) - Текуща MCP спецификация на протокола
- [Най-добри практики за сигурност на MCP](https://modelcontextprotocol.io/specification/2025-06-18/basic/security_best_practices) - Официални насоки за сигурност
- [Спецификация за авторизация на MCP](https://modelcontextprotocol.io/specification/2025-06-18/basic/authorization) - Модели за автентикация и авторизация
- [Сигурност на транспорта на MCP](https://modelcontextprotocol.io/specification/2025-06-18/transports/) - Изисквания за сигурност на транспортния слой

### Решения за сигурност от Microsoft
- [Microsoft Prompt Shields](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection) - Усъвършенствана защита от инжектиране в подсказки
- [Azure Content Safety](https://learn.microsoft.com/azure/ai-services/content-safety/) - Цялостно филтриране на AI съдържание
- [Microsoft Entra ID](https://learn.microsoft.com/entra/identity-platform/v2-oauth2-auth-code-flow) - Управление на идентичност и достъп за предприятия
- [Azure Key Vault](https://learn.microsoft.com/azure/key-vault/general/basic-concepts) - Сигурно управление на тайни и идентификационни данни
- [GitHub Advanced Security](https://github.com/security/advanced-security) - Сканиране на сигурността на веригата за доставки и кода

### Стандарти и рамки за сигурност
- [Най-добри практики за сигурност на OAuth 2.1](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics) - Актуални насоки за сигурност на OAuth
- [OWASP Top 10](https://owasp.org/www-project-top-ten/) - Рискове за сигурността на уеб приложения
- [OWASP Top 10 за LLMs](https://genai.owasp.org/download/43299/?tmstv=1731900559) - Рискове за сигурността, специфични за AI
- [Рамка за управление на рисковете на AI от NIST](https://www.nist.gov/itl/ai-risk-management-framework) - Цялостно управление на рисковете на AI
- [ISO 27001:2022](https://www.iso.org/standard/27001) - Системи за управление на информационната сигурност

### Ръководства и уроци за внедряване
- [Azure API Management като MCP Auth Gateway](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690) - Модели за автентикация за предприятия
- [Microsoft Entra ID с MCP сървъри](https://den.dev/blog/mcp-server-auth-entra-id-session/) - Интеграция на доставчици на идентичност
- [Внедряване на сигурно съхранение на токени](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2) - Най-добри практики за управление на токени
- [Крайно-крайно криптиране за AI](https://learn.microsoft.com/azure/architecture/example-scenario/confidential/end-to-end-encryption) - Усъвършенствани модели за криптиране

### Разширени ресурси за сигурност

- **Разработване на инструменти**: Разработване и споделяне на инструменти и библиотеки за сигурност за екосистемата на MCP

---

*Този документ отразява най-добрите практики за сигурност на MCP към 18 август 2025 г., базирани на MCP Спецификация 2025-06-18. Практиките за сигурност трябва редовно да се преглеждат и актуализират с оглед на развитието на протокола и заплахите.*

**Отказ от отговорност**:  
Този документ е преведен с помощта на AI преводаческа услуга [Co-op Translator](https://github.com/Azure/co-op-translator). Въпреки че се стремим към точност, моля, имайте предвид, че автоматизираните преводи могат да съдържат грешки или неточности. Оригиналният документ на неговия роден език трябва да се счита за авторитетен източник. За критична информация се препоръчва професионален човешки превод. Ние не носим отговорност за каквито и да е недоразумения или неправилни тълкувания, произтичащи от използването на този превод.