<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "68cd055621b3370948a5a1dff7bedc9a",
  "translation_date": "2025-08-26T20:28:28+00:00",
  "source_file": "03-GettingStarted/05-stdio-server/solution/python/README.md",
  "language_code": "ru"
}
-->
# MCP stdio Server - Решение на Python

> **⚠️ Важно**: Это решение было обновлено для использования **stdio транспорта** в соответствии с рекомендациями спецификации MCP от 2025-06-18. Изначальный транспорт SSE устарел.

## Обзор

Это решение на Python демонстрирует, как создать MCP сервер с использованием текущего stdio транспорта. Stdio транспорт проще, безопаснее и обеспечивает лучшую производительность по сравнению с устаревшим подходом SSE.

## Необходимые условия

- Python версии 3.8 или выше
- Рекомендуется установить `uv` для управления пакетами, см. [инструкции](https://docs.astral.sh/uv/#highlights)

## Инструкции по настройке

### Шаг 1: Создайте виртуальное окружение

```bash
python -m venv venv
```

### Шаг 2: Активируйте виртуальное окружение

**Windows:**
```bash
venv\Scripts\activate
```

**macOS/Linux:**
```bash
source venv/bin/activate
```

### Шаг 3: Установите зависимости

```bash
pip install mcp
```

## Запуск сервера

Stdio сервер работает иначе, чем старый сервер SSE. Вместо запуска веб-сервера он взаимодействует через stdin/stdout:

```bash
python server.py
```

**Важно**: Сервер может показаться "зависшим" — это нормально! Он ожидает JSON-RPC сообщений через stdin.

## Тестирование сервера

### Метод 1: Использование MCP Inspector (рекомендуется)

```bash
npx @modelcontextprotocol/inspector python server.py
```

Это позволит:
1. Запустить ваш сервер как подпроцесс
2. Открыть веб-интерфейс для тестирования
3. Интерактивно тестировать все инструменты сервера

### Метод 2: Прямое тестирование JSON-RPC

Вы также можете протестировать сервер, отправляя JSON-RPC сообщения напрямую:

1. Запустите сервер: `python server.py`
2. Отправьте JSON-RPC сообщение (пример):

```json
{"jsonrpc": "2.0", "id": 1, "method": "tools/list"}
```

3. Сервер ответит доступными инструментами

### Доступные инструменты

Сервер предоставляет следующие инструменты:

- **add(a, b)**: Сложение двух чисел
- **multiply(a, b)**: Умножение двух чисел  
- **get_greeting(name)**: Генерация персонализированного приветствия
- **get_server_info()**: Получение информации о сервере

### Тестирование с помощью Claude Desktop

Чтобы использовать этот сервер с Claude Desktop, добавьте следующую конфигурацию в ваш `claude_desktop_config.json`:

```json
{
  "mcpServers": {
    "example-stdio-server": {
      "command": "python",
      "args": ["path/to/server.py"]
    }
  }
}
```

## Основные отличия от SSE

**Stdio транспорт (текущий):**
- ✅ Более простая настройка — веб-сервер не требуется
- ✅ Лучшая безопасность — отсутствуют HTTP-эндпоинты
- ✅ Взаимодействие через подпроцессы
- ✅ JSON-RPC через stdin/stdout
- ✅ Лучшая производительность

**SSE транспорт (устаревший):**
- ❌ Требовалась настройка HTTP-сервера
- ❌ Нужен был веб-фреймворк (Starlette/FastAPI)
- ❌ Более сложная маршрутизация и управление сессиями
- ❌ Дополнительные соображения по безопасности
- ❌ Устарел в MCP 2025-06-18

## Советы по отладке

- Используйте `stderr` для логирования (никогда `stdout`)
- Тестируйте с помощью Inspector для визуальной отладки
- Убедитесь, что все JSON сообщения разделены символом новой строки
- Проверьте, что сервер запускается без ошибок

Это решение соответствует текущей спецификации MCP и демонстрирует лучшие практики для реализации stdio транспорта.

---

**Отказ от ответственности**:  
Этот документ был переведен с помощью сервиса автоматического перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Хотя мы стремимся к точности, пожалуйста, учитывайте, что автоматические переводы могут содержать ошибки или неточности. Оригинальный документ на его родном языке следует считать авторитетным источником. Для получения критически важной информации рекомендуется профессиональный перевод человеком. Мы не несем ответственности за любые недоразумения или неправильные интерпретации, возникающие в результате использования данного перевода.