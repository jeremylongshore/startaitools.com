<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "057dd5cc6bea6434fdb788e6c93f3f3d",
  "translation_date": "2025-08-18T11:08:56+00:00",
  "source_file": "02-Security/mcp-security-best-practices-2025.md",
  "language_code": "ja"
}
-->
# MCPセキュリティベストプラクティス - 2025年8月更新

> **重要**: このドキュメントは、最新の[MCP仕様 2025-06-18](https://spec.modelcontextprotocol.io/specification/2025-06-18/)のセキュリティ要件および公式の[MCPセキュリティベストプラクティス](https://modelcontextprotocol.io/specification/2025-06-18/basic/security_best_practices)を反映しています。常に最新の仕様を参照して、最新のガイダンスを確認してください。

## MCP実装のための基本的なセキュリティプラクティス

Model Context Protocol（MCP）は、従来のソフトウェアセキュリティを超えた独自のセキュリティ課題をもたらします。これらのプラクティスは、基本的なセキュリティ要件と、プロンプトインジェクション、ツールポイズニング、セッションハイジャック、混乱した代理問題、トークンパススルー脆弱性などのMCP特有の脅威に対応します。

### **必須セキュリティ要件**

**MCP仕様からの重要な要件:**

> **MUST NOT**: MCPサーバーは、MCPサーバーのために明示的に発行されていないトークンを受け入れてはなりません。
> 
> **MUST**: 認可を実装するMCPサーバーは、すべての受信リクエストを検証する必要があります。
>  
> **MUST NOT**: MCPサーバーは、認証のためにセッションを使用してはなりません。
>
> **MUST**: 静的なクライアントIDを使用するMCPプロキシサーバーは、動的に登録されたクライアントごとにユーザーの同意を得る必要があります。

---

## 1. **トークンセキュリティと認証**

**認証と認可のコントロール:**
   - **厳格な認可レビュー**: MCPサーバーの認可ロジックを徹底的に監査し、意図したユーザーとクライアントのみがリソースにアクセスできるようにする
   - **外部IDプロバイダーの統合**: カスタム認証を実装するのではなく、Microsoft Entra IDなどの確立されたIDプロバイダーを使用する
   - **トークンのオーディエンス検証**: トークンが明示的にMCPサーバーのために発行されたことを常に検証し、上流のトークンを受け入れない
   - **適切なトークンライフサイクル管理**: セキュアなトークンのローテーション、期限ポリシーを実装し、トークンリプレイ攻撃を防ぐ

**トークンの保護されたストレージ:**
   - Azure Key Vaultや同様のセキュアな資格情報ストアを使用する
   - トークンを保存時および転送時に暗号化する
   - 資格情報の定期的なローテーションと不正アクセスの監視を実施する

## 2. **セッション管理とトランスポートセキュリティ**

**セキュアなセッションプラクティス:**
   - **暗号的にセキュアなセッションID**: セキュアな乱数生成器を使用して生成された非決定論的なセッションIDを使用する
   - **ユーザー固有のバインディング**: `<user_id>:<session_id>`の形式でセッションIDをユーザーIDにバインドし、ユーザー間のセッション悪用を防ぐ
   - **セッションライフサイクル管理**: 適切な期限設定、ローテーション、無効化を実施し、脆弱性の窓を最小化する
   - **HTTPS/TLSの強制**: セッションIDの傍受を防ぐため、すべての通信でHTTPSを必須とする

**トランスポート層セキュリティ:**
   - TLS 1.3を可能な限り構成し、適切な証明書管理を行う
   - 重要な接続に対して証明書ピンニングを実装する
   - 証明書の定期的なローテーションと有効性の確認を行う

## 3. **AI特有の脅威保護** 🤖

**プロンプトインジェクション防御:**
   - **Microsoft Prompt Shields**: 悪意のある指示の高度な検出とフィルタリングのためにAI Prompt Shieldsを展開する
   - **入力のサニタイズ**: インジェクション攻撃や混乱した代理問題を防ぐために、すべての入力を検証しサニタイズする
   - **コンテンツ境界の設定**: 信頼された指示と外部コンテンツを区別するために、デリミタやデータマーキングシステムを使用する

**ツールポイズニング防止:**
   - **ツールメタデータの検証**: ツール定義の整合性チェックを実施し、予期しない変更を監視する
   - **動的ツール監視**: 実行時の動作を監視し、予期しない実行パターンに対するアラートを設定する
   - **承認ワークフロー**: ツールの変更や機能の変更に対して明示的なユーザー承認を要求する

## 4. **アクセス制御と権限管理**

**最小権限の原則:**
   - MCPサーバーに必要最小限の権限のみを付与する
   - 細かい権限を持つロールベースのアクセス制御（RBAC）を実装する
   - 権限の定期的なレビューと特権昇格の監視を行う

**実行時の権限コントロール:**
   - リソース枯渇攻撃を防ぐためにリソース制限を適用する
   - ツール実行環境にコンテナ分離を使用する
   - 管理機能に対してジャストインタイムアクセスを実装する

## 5. **コンテンツの安全性と監視**

**コンテンツ安全性の実装:**
   - **Azure Content Safetyの統合**: 有害なコンテンツ、脱獄試み、ポリシー違反を検出するためにAzure Content Safetyを使用する
   - **行動分析**: 実行時の行動監視を実施し、MCPサーバーやツールの実行における異常を検出する
   - **包括的なログ記録**: 認証試行、ツール呼び出し、セキュリティイベントをすべて安全で改ざん防止のストレージに記録する

**継続的な監視:**
   - 不審なパターンや不正アクセス試行に対するリアルタイムアラート
   - セキュリティイベントを集中管理するためのSIEMシステムとの統合
   - MCP実装の定期的なセキュリティ監査とペネトレーションテスト

## 6. **サプライチェーンセキュリティ**

**コンポーネント検証:**
   - **依存関係スキャン**: すべてのソフトウェア依存関係とAIコンポーネントに対して自動脆弱性スキャンを使用する
   - **出所の検証**: モデル、データソース、外部サービスの出所、ライセンス、整合性を確認する
   - **署名付きパッケージ**: 暗号的に署名されたパッケージを使用し、デプロイ前に署名を検証する

**セキュアな開発パイプライン:**
   - **GitHub Advanced Security**: シークレットスキャン、依存関係分析、CodeQL静的解析を実装する
   - **CI/CDセキュリティ**: 自動デプロイメントパイプライン全体でセキュリティ検証を統合する
   - **アーティファクトの整合性**: デプロイされたアーティファクトと構成に対して暗号的検証を実施する

## 7. **OAuthセキュリティと混乱した代理問題の防止**

**OAuth 2.1の実装:**
   - **PKCEの実装**: すべての認可リクエストに対してProof Key for Code Exchange（PKCE）を使用する
   - **明示的な同意**: 混乱した代理攻撃を防ぐために、動的に登録されたクライアントごとにユーザーの同意を得る
   - **リダイレクトURIの検証**: リダイレクトURIとクライアント識別子の厳格な検証を実施する

**プロキシセキュリティ:**
   - 静的クライアントIDの悪用による認可バイパスを防ぐ
   - サードパーティAPIアクセスに対する適切な同意ワークフローを実装する
   - 認可コードの盗難や不正なAPIアクセスを監視する

## 8. **インシデント対応と復旧**

**迅速な対応能力:**
   - **自動対応**: 資格情報のローテーションや脅威の封じ込めのための自動システムを実装する
   - **ロールバック手順**: 既知の良好な構成やコンポーネントに迅速に戻す能力を持つ
   - **フォレンジック能力**: インシデント調査のための詳細な監査証跡とログを保持する

**コミュニケーションと調整:**
   - セキュリティインシデントに対する明確なエスカレーション手順
   - 組織のインシデント対応チームとの統合
   - 定期的なセキュリティインシデントシミュレーションとテーブルトップ演習

## 9. **コンプライアンスとガバナンス**

**規制コンプライアンス:**
   - MCP実装が業界固有の要件（GDPR、HIPAA、SOC 2）を満たしていることを確認する
   - AIデータ処理のためのデータ分類とプライバシーコントロールを実装する
   - コンプライアンス監査のための包括的なドキュメントを維持する

**変更管理:**
   - MCPシステムのすべての変更に対する正式なセキュリティレビュー手順
   - 構成変更のバージョン管理と承認ワークフロー
   - 定期的なコンプライアンス評価とギャップ分析

## 10. **高度なセキュリティコントロール**

**ゼロトラストアーキテクチャ:**
   - **信頼せず、常に検証する**: ユーザー、デバイス、接続の継続的な検証
   - **マイクロセグメンテーション**: 個々のMCPコンポーネントを分離する細かいネットワークコントロール
   - **条件付きアクセス**: 現在のコンテキストや行動に適応するリスクベースのアクセスコントロール

**実行時アプリケーション保護:**
   - **実行時アプリケーション自己保護（RASP）**: リアルタイムの脅威検出のためにRASP技術を展開する
   - **アプリケーションパフォーマンス監視**: 攻撃を示す可能性のあるパフォーマンス異常を監視する
   - **動的セキュリティポリシー**: 現在の脅威状況に基づいて適応するセキュリティポリシーを実装する

## 11. **Microsoftセキュリティエコシステムの統合**

**包括的なMicrosoftセキュリティ:**
   - **Microsoft Defender for Cloud**: MCPワークロードのクラウドセキュリティポスチャ管理
   - **Azure Sentinel**: 高度な脅威検出のためのクラウドネイティブSIEMおよびSOAR機能
   - **Microsoft Purview**: AIワークフローやデータソースのデータガバナンスとコンプライアンス

**IDとアクセス管理:**
   - **Microsoft Entra ID**: 条件付きアクセスポリシーを備えたエンタープライズID管理
   - **Privileged Identity Management（PIM）**: 管理機能のためのジャストインタイムアクセスと承認ワークフロー
   - **Identity Protection**: リスクベースの条件付きアクセスと自動脅威対応

## 12. **継続的なセキュリティ進化**

**最新情報の維持:**
   - **仕様の監視**: MCP仕様の更新とセキュリティガイダンスの変更を定期的に確認する
   - **脅威インテリジェンス**: AI特有の脅威フィードや侵害指標の統合
   - **セキュリティコミュニティへの参加**: MCPセキュリティコミュニティや脆弱性開示プログラムへの積極的な参加

**適応型セキュリティ:**
   - **機械学習セキュリティ**: 新しい攻撃パターンを特定するためのMLベースの異常検出を使用する
   - **予測的セキュリティ分析**: 脅威を事前に特定するための予測モデルを実装する
   - **セキュリティの自動化**: 脅威インテリジェンスや仕様変更に基づいてセキュリティポリシーを自動更新する

---

## **重要なセキュリティリソース**

### **公式MCPドキュメント**
- [MCP仕様（2025-06-18）](https://spec.modelcontextprotocol.io/specification/2025-06-18/)
- [MCPセキュリティベストプラクティス](https://modelcontextprotocol.io/specification/2025-06-18/basic/security_best_practices)
- [MCP認可仕様](https://modelcontextprotocol.io/specification/2025-06-18/basic/authorization)

### **Microsoftセキュリティソリューション**
- [Microsoft Prompt Shields](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)
- [Azure Content Safety](https://learn.microsoft.com/azure/ai-services/content-safety/)
- [Microsoft Entra IDセキュリティ](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [GitHub Advanced Security](https://github.com/security/advanced-security)

### **セキュリティ標準**
- [OAuth 2.0セキュリティベストプラクティス（RFC 9700）](https://datatracker.ietf.org/doc/html/rfc9700)
- [OWASP Top 10 for Large Language Models](https://genai.owasp.org/)
- [NIST AIリスク管理フレームワーク](https://www.nist.gov/itl/ai-risk-management-framework)

### **実装ガイド**
- [Azure API Management MCP認証ゲートウェイ](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [Microsoft Entra IDとMCPサーバー](https://den.dev/blog/mcp-server-auth-entra-id-session/)

---

> **セキュリティ通知**: MCPセキュリティプラクティスは急速に進化しています。実装前に常に最新の[MCP仕様](https://spec.modelcontextprotocol.io/)および[公式セキュリティドキュメント](https://modelcontextprotocol.io/specification/2025-06-18/basic/security_best_practices)を確認してください。

**免責事項**:  
この文書は、AI翻訳サービス [Co-op Translator](https://github.com/Azure/co-op-translator) を使用して翻訳されています。正確性を追求しておりますが、自動翻訳には誤りや不正確な部分が含まれる可能性があります。元の言語で記載された文書が正式な情報源と見なされるべきです。重要な情報については、専門の人間による翻訳を推奨します。この翻訳の利用に起因する誤解や誤認について、当方は一切の責任を負いません。