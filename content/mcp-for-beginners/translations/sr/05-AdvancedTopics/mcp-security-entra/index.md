<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "6e562d7e5a77c8982da4aa8f762ad1d8",
  "translation_date": "2025-07-14T03:17:30+00:00",
  "source_file": "05-AdvancedTopics/mcp-security-entra/README.md",
  "language_code": "sr"
}
-->
# –û—Å–∏–≥—É—Ä–∞—ö–µ AI —Ä–∞–¥–Ω–∏—Ö —Ç–æ–∫–æ–≤–∞: Entra ID –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ –∑–∞ Model Context Protocol —Å–µ—Ä–≤–µ—Ä–µ

## –£–≤–æ–¥  
–û—Å–∏–≥—É—Ä–∞—ö–µ –≤–∞—à–µ–≥ Model Context Protocol (MCP) —Å–µ—Ä–≤–µ—Ä–∞ —ò–µ –ø–æ–¥—ò–µ–¥–Ω–∞–∫–æ –≤–∞–∂–Ω–æ –∫–∞–æ –∏ –∑–∞–∫—ô—É—á–∞–≤–∞—ö–µ —É–ª–∞–∑–Ω–∏—Ö –≤—Ä–∞—Ç–∞ –∫—É—õ–µ. –û—Å—Ç–∞–≤—ô–∞—ö–µ MCP —Å–µ—Ä–≤–µ—Ä–∞ –æ—Ç–≤–æ—Ä–µ–Ω–∏–º –∏–∑–ª–∞–∂–µ –≤–∞—à–µ –∞–ª–∞—Ç–µ –∏ –ø–æ–¥–∞—Ç–∫–µ –Ω–µ–æ–≤–ª–∞—à—õ–µ–Ω–æ–º –ø—Ä–∏—Å—Ç—É–ø—É, —à—Ç–æ –º–æ–∂–µ –¥–æ–≤–µ—Å—Ç–∏ –¥–æ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∏—Ö –ø—Ä–æ–ø—É—Å—Ç–∞. Microsoft Entra ID –ø—Ä—É–∂–∞ –ø–æ—É–∑–¥–∞–Ω–æ —Ä–µ—à–µ—ö–µ –∑–∞ —É–ø—Ä–∞–≤—ô–∞—ö–µ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–æ–º –∏ –ø—Ä–∏—Å—Ç—É–ø–æ–º —É –æ–±–ª–∞–∫—É, –ø–æ–º–∞–∂—É—õ–∏ –¥–∞ —Å–∞–º–æ –æ–≤–ª–∞—à—õ–µ–Ω–∏ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏ –∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ –º–æ–≥—É –¥–∞ –∫–æ–º—É–Ω–∏—Ü–∏—Ä–∞—ò—É —Å–∞ –≤–∞—à–∏–º MCP —Å–µ—Ä–≤–µ—Ä–æ–º. –£ –æ–≤–æ–º –¥–µ–ª—É –Ω–∞—É—á–∏—õ–µ—Ç–µ –∫–∞–∫–æ –¥–∞ –∑–∞—à—Ç–∏—Ç–∏—Ç–µ —Å–≤–æ—ò–µ AI —Ä–∞–¥–Ω–µ —Ç–æ–∫–æ–≤–µ –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ Entra ID –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É.

## –¶–∏—ô–µ–≤–∏ —É—á–µ—ö–∞  
–î–æ –∫—Ä–∞—ò–∞ –æ–≤–æ–≥ –¥–µ–ª–∞ –º–æ—õ–∏ —õ–µ—Ç–µ –¥–∞:

- –†–∞–∑—É–º–µ—Ç–µ –∑–Ω–∞—á–∞—ò –æ—Å–∏–≥—É—Ä–∞—ö–∞ MCP —Å–µ—Ä–≤–µ—Ä–∞.  
- –û–±—ò–∞—Å–Ω–∏—Ç–µ –æ—Å–Ω–æ–≤–µ Microsoft Entra ID –∏ OAuth 2.0 –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ.  
- –ü—Ä–µ–ø–æ–∑–Ω–∞—Ç–µ —Ä–∞–∑–ª–∏–∫—É –∏–∑–º–µ—í—É —ò–∞–≤–Ω–∏—Ö –∏ –ø–æ–≤–µ—Ä—ô–∏–≤–∏—Ö –∫–ª–∏—ò–µ–Ω–∞—Ç–∞.  
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—Ç–µ Entra ID –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É —É –ª–æ–∫–∞–ª–Ω–∏–º (—ò–∞–≤–Ω–∏ –∫–ª–∏—ò–µ–Ω—Ç) –∏ —É–¥–∞—ô–µ–Ω–∏–º (–ø–æ–≤–µ—Ä—ô–∏–≤–∏ –∫–ª–∏—ò–µ–Ω—Ç) MCP —Å–µ—Ä–≤–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—ò–∏–º–∞.  
- –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –Ω–∞—ò–±–æ—ô–µ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ –ø—Ä–∞–∫—Å–µ –ø—Ä–∏–ª–∏–∫–æ–º —Ä–∞–∑–≤–æ—ò–∞ AI —Ä–∞–¥–Ω–∏—Ö —Ç–æ–∫–æ–≤–∞.

## –ë–µ–∑–±–µ–¥–Ω–æ—Å—Ç –∏ MCP  

–ë–∞—à –∫–∞–æ —à—Ç–æ –Ω–µ –±–∏—Å—Ç–µ –æ—Å—Ç–∞–≤–∏–ª–∏ —É–ª–∞–∑–Ω–∞ –≤—Ä–∞—Ç–∞ –∫—É—õ–µ –æ—Ç–∫—ô—É—á–∞–Ω–∞, —Ç–∞–∫–æ –Ω–µ —Ç—Ä–µ–±–∞ –¥–∞ –æ—Å—Ç–∞–≤—ô–∞—Ç–µ MCP —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–æ—Ä–µ–Ω–∏–º –∑–∞ –ø—Ä–∏—Å—Ç—É–ø —Å–≤–∏–º–∞. –û—Å–∏–≥—É—Ä–∞—ö–µ –≤–∞—à–∏—Ö AI —Ä–∞–¥–Ω–∏—Ö —Ç–æ–∫–æ–≤–∞ —ò–µ –∫—ô—É—á–Ω–æ –∑–∞ –∏–∑–≥—Ä–∞–¥—ö—É —Ä–æ–±—É—Å–Ω–∏—Ö, –ø–æ—É–∑–¥–∞–Ω–∏—Ö –∏ –±–µ–∑–±–µ–¥–Ω–∏—Ö –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞. –û–≤–æ –ø–æ–≥–ª–∞–≤—ô–µ —õ–µ –≤–∞—Å —É–ø–æ–∑–Ω–∞—Ç–∏ —Å–∞ –∫–æ—Ä–∏—à—õ–µ—ö–µ–º Microsoft Entra ID –∑–∞ –∑–∞—à—Ç–∏—Ç—É –≤–∞—à–∏—Ö MCP —Å–µ—Ä–≤–µ—Ä–∞, –æ—Å–∏–≥—É—Ä–∞–≤–∞—ò—É—õ–∏ –¥–∞ —Å–∞–º–æ –æ–≤–ª–∞—à—õ–µ–Ω–∏ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏ –∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ –º–æ–≥—É –¥–∞ –ø—Ä–∏—Å—Ç—É–ø–µ –≤–∞—à–∏–º –∞–ª–∞—Ç–∏–º–∞ –∏ –ø–æ–¥–∞—Ü–∏–º–∞.

## –ó–∞—à—Ç–æ —ò–µ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç –≤–∞–∂–Ω–∞ –∑–∞ MCP —Å–µ—Ä–≤–µ—Ä–µ  

–ó–∞–º–∏—Å–ª–∏—Ç–µ –¥–∞ –≤–∞—à MCP —Å–µ—Ä–≤–µ—Ä –∏–º–∞ –∞–ª–∞—Ç –∫–æ—ò–∏ –º–æ–∂–µ –¥–∞ —à–∞—ô–µ –∏–º–µ—ò–ª–æ–≤–µ –∏–ª–∏ –ø—Ä–∏—Å—Ç—É–ø–∞ –±–∞–∑–∏ –ø–æ–¥–∞—Ç–∞–∫–∞ –∫–ª–∏—ò–µ–Ω–∞—Ç–∞. –ù–µ—Å–∏–≥—É—Ä–∞–Ω —Å–µ—Ä–≤–µ—Ä –∑–Ω–∞—á–∏ –¥–∞ –±–∏–ª–æ –∫–æ –º–æ–∂–µ –ø–æ—Ç–µ–Ω—Ü–∏—ò–∞–ª–Ω–æ –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏ —Ç–∞—ò –∞–ª–∞—Ç, —à—Ç–æ –º–æ–∂–µ –¥–æ–≤–µ—Å—Ç–∏ –¥–æ –Ω–µ–æ–≤–ª–∞—à—õ–µ–Ω–æ–≥ –ø—Ä–∏—Å—Ç—É–ø–∞ –ø–æ–¥–∞—Ü–∏–º–∞, —Å–ª–∞—ö–∞ —Å–ø–∞–º–∞ –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∑–ª–æ–Ω–∞–º–µ—Ä–Ω–∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

–ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—ö–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ –æ—Å–∏–≥—É—Ä–∞–≤–∞—Ç–µ –¥–∞ —Å–≤–∞–∫–∏ –∑–∞—Ö—Ç–µ–≤ –∫–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä—É –±—É–¥–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω, –ø–æ—Ç–≤—Ä—í—É—ò—É—õ–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –∫–æ—Ä–∏—Å–Ω–∏–∫–∞ –∏–ª–∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ –∫–æ—ò–∞ —à–∞—ô–µ –∑–∞—Ö—Ç–µ–≤. –û–≤–æ —ò–µ –ø—Ä–≤–∏ –∏ –Ω–∞—ò–≤–∞–∂–Ω–∏—ò–∏ –∫–æ—Ä–∞–∫ —É –æ—Å–∏–≥—É—Ä–∞—ö—É –≤–∞—à–∏—Ö AI —Ä–∞–¥–Ω–∏—Ö —Ç–æ–∫–æ–≤–∞.

## –£–≤–æ–¥ —É Microsoft Entra ID  

[**Microsoft Entra ID**](https://adoption.microsoft.com/microsoft-security/entra/) —ò–µ —É—Å–ª—É–≥–∞ –∑–∞ —É–ø—Ä–∞–≤—ô–∞—ö–µ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–æ–º –∏ –ø—Ä–∏—Å—Ç—É–ø–æ–º —É –æ–±–ª–∞–∫—É. –ú–æ–∂–µ—Ç–µ –≥–∞ –∑–∞–º–∏—Å–ª–∏—Ç–∏ –∫–∞–æ —É–Ω–∏–≤–µ—Ä–∑–∞–ª–Ω–æ–≥ —á—É–≤–∞—Ä–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç–∏ –∑–∞ –≤–∞—à–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ. –û–Ω –æ–±—Ä–∞—í—É—ò–µ —Å–ª–æ–∂–µ–Ω –ø—Ä–æ—Ü–µ—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–∞ (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É) –∏ –æ–¥—Ä–µ—í–∏–≤–∞—ö–∞ —à—Ç–∞ –∏–º —ò–µ –¥–æ–∑–≤–æ—ô–µ–Ω–æ –¥–∞ —Ä–∞–¥–µ (–∞—É—Ç–æ—Ä–∞—Ü–∏—ò—É).

–ö–æ—Ä–∏—à—õ–µ—ö–µ–º Entra ID –º–æ–∂–µ—Ç–µ:

- –û–º–æ–≥—É—õ–∏—Ç–∏ –±–µ–∑–±–µ–¥–∞–Ω –ø—Ä–∏—ò–∞–≤—ô–∏–≤–∞—ö–µ –∫–æ—Ä–∏—Å–Ω–∏–∫–∞.  
- –ó–∞—à—Ç–∏—Ç–∏—Ç–∏ API-—ò–µ –∏ —Å–µ—Ä–≤–∏—Å–µ.  
- –£–ø—Ä–∞–≤—ô–∞—Ç–∏ –ø–æ–ª–∏—Ç–∏–∫–∞–º–∞ –ø—Ä–∏—Å—Ç—É–ø–∞ —Å–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–µ –ª–æ–∫–∞—Ü–∏—ò–µ.

–ó–∞ MCP —Å–µ—Ä–≤–µ—Ä–µ, Entra ID –ø—Ä—É–∂–∞ –ø–æ—É–∑–¥–∞–Ω–æ –∏ —à–∏—Ä–æ–∫–æ –ø—Ä–∏—Ö–≤–∞—õ–µ–Ω–æ —Ä–µ—à–µ—ö–µ –∑–∞ —É–ø—Ä–∞–≤—ô–∞—ö–µ —Ç–∏–º–µ –∫–æ –º–æ–∂–µ –¥–∞ –ø—Ä–∏—Å—Ç—É–ø–∏ –º–æ–≥—É—õ–Ω–æ—Å—Ç–∏–º–∞ –≤–∞—à–µ–≥ —Å–µ—Ä–≤–µ—Ä–∞.

---

## –†–∞–∑—É–º–µ–≤–∞—ö–µ –º–∞–≥–∏—ò–µ: –ö–∞–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—à–µ Entra ID –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞  

Entra ID –∫–æ—Ä–∏—Å—Ç–∏ –æ—Ç–≤–æ—Ä–µ–Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä–¥–µ –∫–∞–æ —à—Ç–æ —ò–µ **OAuth 2.0** –∑–∞ –æ–±—Ä–∞–¥—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ. –ò–∞–∫–æ –¥–µ—Ç–∞—ô–∏ –º–æ–≥—É –±–∏—Ç–∏ —Å–ª–æ–∂–µ–Ω–∏, –æ—Å–Ω–æ–≤–Ω–∞ –∏–¥–µ—ò–∞ —ò–µ —ò–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–∞ –∏ –º–æ–∂–µ —Å–µ —Ä–∞–∑—É–º–µ—Ç–∏ –∫—Ä–æ–∑ –∞–Ω–∞–ª–æ–≥–Ω–∏ –ø—Ä–∏–º–µ—Ä.

### –ù–µ–∂–∞–Ω —É–≤–æ–¥ —É OAuth 2.0: –ö—ô—É—á –∑–∞ –ø–∞—Ä–∫–∏—Ä–∞—ö–µ  

–ó–∞–º–∏—Å–ª–∏—Ç–µ OAuth 2.0 –∫–∞–æ —É—Å–ª—É–≥—É –ø–∞—Ä–∫–∏—Ä–∞—ö–∞ –≤–∞—à–µ–≥ –∞—É—Ç–æ–º–æ–±–∏–ª–∞. –ö–∞–¥–∞ —Å—Ç–∏–≥–Ω–µ—Ç–µ —É —Ä–µ—Å—Ç–æ—Ä–∞–Ω, –Ω–µ –¥–∞—ò–µ—Ç–µ –ø–∞—Ä–∫–∏—Ä–∞—á—É –≥–ª–∞–≤–Ω–∏ –∫—ô—É—á. –£–º–µ—Å—Ç–æ —Ç–æ–≥–∞, –¥–∞—ò–µ—Ç–µ **–∫—ô—É—á –∑–∞ –ø–∞—Ä–∫–∏—Ä–∞—ö–µ** –∫–æ—ò–∏ –∏–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –æ–≤–ª–∞—à—õ–µ—ö–∞ ‚Äî –º–æ–∂–µ –¥–∞ —É–ø–∞–ª–∏ –∞—É—Ç–æ –∏ –∑–∞–∫—ô—É—á–∞ –≤—Ä–∞—Ç–∞, –∞–ª–∏ –Ω–µ –º–æ–∂–µ –¥–∞ –æ—Ç–≤–æ—Ä–∏ –ø—Ä—Ç—ô–∞–∂–Ω–∏–∫ –∏–ª–∏ —Ä—É–∫–∞–≤a—Ü.

–£ –æ–≤–æ—ò –∞–Ω–∞–ª–æ–≥–∏—ò–∏:

- **–í–∏** —Å—Ç–µ **–ö–æ—Ä–∏—Å–Ω–∏–∫**.  
- **–í–∞—à –∞—É—Ç–æ** —ò–µ **MCP —Å–µ—Ä–≤–µ—Ä** —Å–∞ –≤—Ä–µ–¥–Ω–∏–º –∞–ª–∞—Ç–∏–º–∞ –∏ –ø–æ–¥–∞—Ü–∏–º–∞.  
- **–ü–∞—Ä–∫–∏—Ä–∞—á** —ò–µ **Microsoft Entra ID**.  
- **–ü–∞—Ä–∫–ª–∏—Ä–∞—ò—É—õ–∏ —Ä–∞–¥–Ω–∏–∫** —ò–µ **MCP –∫–ª–∏—ò–µ–Ω—Ç** (–∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ –∫–æ—ò–∞ –ø–æ–∫—É—à–∞–≤–∞ –¥–∞ –ø—Ä–∏—Å—Ç—É–ø–∏ —Å–µ—Ä–≤–µ—Ä—É).  
- **–ö—ô—É—á –∑–∞ –ø–∞—Ä–∫–∏—Ä–∞—ö–µ** —ò–µ **Access Token**.

Access token —ò–µ –±–µ–∑–±–µ–¥–∞–Ω –Ω–∏–∑ —Ç–µ–∫—Å—Ç–∞ –∫–æ—ò–∏ MCP –∫–ª–∏—ò–µ–Ω—Ç –¥–æ–±–∏—ò–∞ –æ–¥ Entra ID –Ω–∞–∫–æ–Ω —à—Ç–æ —Å–µ –ø—Ä–∏—ò–∞–≤–∏—Ç–µ. –ö–ª–∏—ò–µ–Ω—Ç –∑–∞—Ç–∏–º –ø—Ä–µ–¥—Å—Ç–∞–≤—ô–∞ –æ–≤–∞—ò —Ç–æ–∫–µ–Ω MCP —Å–µ—Ä–≤–µ—Ä—É –ø—Ä–∏ —Å–≤–∞–∫–æ–º –∑–∞—Ö—Ç–µ–≤—É. –°–µ—Ä–≤–µ—Ä –º–æ–∂–µ –¥–∞ –ø—Ä–æ–≤–µ—Ä–∏ —Ç–æ–∫–µ–Ω –∫–∞–∫–æ –±–∏ —Å–µ —É–≤–µ—Ä–∏–æ –¥–∞ —ò–µ –∑–∞—Ö—Ç–µ–≤ –ª–µ–≥–∏—Ç–∏–º–∞–Ω –∏ –¥–∞ –∫–ª–∏—ò–µ–Ω—Ç –∏–º–∞ –ø–æ—Ç—Ä–µ–±–Ω–∞ –æ–≤–ª–∞—à—õ–µ—ö–∞, —Å–≤–µ —Ç–æ –±–µ–∑ –ø–æ—Ç—Ä–µ–±–µ –¥–∞ —Ä—É–∫—É—ò–µ –≤–∞—à–∏–º —Å—Ç–≤–∞—Ä–Ω–∏–º –∞–∫—Ä–µ–¥–∏—Ç–∏–≤–∏–º–∞ (–∫–∞–æ —à—Ç–æ —ò–µ –ª–æ–∑–∏–Ω–∫–∞).

### –¢–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ  

–ï–≤–æ –∫–∞–∫–æ –ø—Ä–æ—Ü–µ—Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—à–µ —É –ø—Ä–∞–∫—Å–∏:

```mermaid
sequenceDiagram
    actor User as üë§ User
    participant Client as üñ•Ô∏è MCP Client
    participant Entra as üîê Microsoft Entra ID
    participant Server as üîß MCP Server

    Client->>+User: Please sign in to continue.
    User->>+Entra: Enters credentials (username/password).
    Entra-->>Client: Here is your access token.
    User-->>-Client: (Returns to the application)

    Client->>+Server: I need to use a tool. Here is my access token.
    Server->>+Entra: Is this access token valid?
    Entra-->>-Server: Yes, it is.
    Server-->>-Client: Token is valid. Here is the result of the tool.
```

### –£–ø–æ–∑–Ω–∞–≤–∞—ö–µ —Å–∞ Microsoft Authentication Library (MSAL)  

–ü—Ä–µ –Ω–µ–≥–æ —à—Ç–æ –ø—Ä–µ—í–µ–º–æ –Ω–∞ –∫–æ–¥, –≤–∞–∂–Ω–æ —ò–µ —É–ø–æ–∑–Ω–∞—Ç–∏ —Å–µ —Å–∞ –∫—ô—É—á–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º –∫–æ—ò—É —õ–µ—Ç–µ –≤–∏–¥–µ—Ç–∏ —É –ø—Ä–∏–º–µ—Ä–∏–º–∞: **Microsoft Authentication Library (MSAL)**.

MSAL —ò–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–æ—ò—É —ò–µ —Ä–∞–∑–≤–∏–æ Microsoft –∏ –∫–æ—ò–∞ –ø—Ä–æ–≥—Ä–∞–º–µ—Ä–∏–º–∞ –∑–Ω–∞—Ç–Ω–æ –æ–ª–∞–∫—à–∞–≤–∞ —Ä—É–∫–æ–≤–∞—ö–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–æ–º. –£–º–µ—Å—Ç–æ –¥–∞ –≤–∏ –ø–∏—à–µ—Ç–µ —Å–∞–≤ —Å–ª–æ–∂–µ–Ω–∏ –∫–æ–¥ –∑–∞ —Ä—É–∫–æ–≤–∞—ö–µ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∏–º —Ç–æ–∫–µ–Ω–∏–º–∞, —É–ø—Ä–∞–≤—ô–∞—ö–µ –ø—Ä–∏—ò–∞–≤–∞–º–∞ –∏ –æ—Å–≤–µ–∂–∞–≤–∞—ö–µ —Å–µ—Å–∏—ò–∞, MSAL –æ–±–∞–≤—ô–∞ —Ç–∞—ò —Ç–µ–∂–∞–∫ –ø–æ—Å–∞–æ.

–ö–æ—Ä–∏—à—õ–µ—ö–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –∫–∞–æ —à—Ç–æ —ò–µ MSAL —Å–µ —Ç–æ–ø–ª–æ –ø—Ä–µ–ø–æ—Ä—É—á—É—ò–µ —ò–µ—Ä:

- **–ë–µ–∑–±–µ–¥–Ω–∞ —ò–µ:** –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞ –∏–Ω–¥—É—Å—Ç—Ä–∏—ò—Å–∫–µ —Å—Ç–∞–Ω–¥–∞—Ä–¥–µ –∏ –Ω–∞—ò–±–æ—ô–µ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ –ø—Ä–∞–∫—Å–µ, —Å–º–∞—ö—É—ò—É—õ–∏ —Ä–∏–∑–∏–∫ –æ–¥ —Ä–∞—ö–∏–≤–æ—Å—Ç–∏ —É –≤–∞—à–µ–º –∫–æ–¥—É.  
- **–ü–æ—ò–µ–¥–Ω–æ—Å—Ç–∞–≤—ô—É—ò–µ —Ä–∞–∑–≤–æ—ò:** –ê–ø—Å—Ç—Ä–∞—Ö—É—ò–µ —Å–ª–æ–∂–µ–Ω–æ—Å—Ç OAuth 2.0 –∏ OpenID Connect –ø—Ä–æ—Ç–æ–∫–æ–ª–∞, –æ–º–æ–≥—É—õ–∞–≤–∞—ò—É—õ–∏ –≤–∞–º –¥–∞ –¥–æ–¥–∞—Ç–µ —Ä–æ–±—É—Å–Ω—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É —É –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É —Å–∞ —Å–∞–º–æ –Ω–µ–∫–æ–ª–∏–∫–æ —Ä–µ–¥–æ–≤–∞ –∫–æ–¥–∞.  
- **–û–¥—Ä–∂–∞–≤–∞ —Å–µ:** Microsoft –∞–∫—Ç–∏–≤–Ω–æ –æ–¥—Ä–∂–∞–≤–∞ –∏ –∞–∂—É—Ä–∏—Ä–∞ MSAL –∫–∞–∫–æ –±–∏ –æ–¥–≥–æ–≤–æ—Ä–∏–æ –Ω–∞ –Ω–æ–≤–µ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ –ø—Ä–µ—Ç—ö–µ –∏ –ø—Ä–æ–º–µ–Ω–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏.

MSAL –ø–æ–¥—Ä–∂–∞–≤–∞ —à–∏—Ä–æ–∫ —Å–ø–µ–∫—Ç–∞—Ä —ò–µ–∑–∏–∫–∞ –∏ –æ–∫–≤–∏—Ä–∞ –∑–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ, —É–∫—ô—É—á—É—ò—É—õ–∏ .NET, JavaScript/TypeScript, Python, Java, Go –∏ –º–æ–±–∏–ª–Ω–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –∫–∞–æ —à—Ç–æ —Å—É iOS –∏ Android. –¢–æ –∑–Ω–∞—á–∏ –¥–∞ –º–æ–∂–µ—Ç–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –∏—Å—Ç–µ –∫–æ–Ω–∑–∏—Å—Ç–µ–Ω—Ç–Ω–µ –æ–±—Ä–∞—Å—Ü–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ —É —Ü–µ–ª–æ–∫—É–ø–Ω–æ–º —Ç–µ—Ö–Ω–æ–ª–æ—à–∫–æ–º —Å—Ç–µ–∫—É.

–ó–∞ –≤–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞ –æ MSAL, –º–æ–∂–µ—Ç–µ –ø–æ–≥–ª–µ–¥–∞—Ç–∏ –∑–≤–∞–Ω–∏—á–Ω—É [MSAL overview –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—ò—É](https://learn.microsoft.com/entra/identity-platform/msal-overview).

---

## –û—Å–∏–≥—É—Ä–∞—ö–µ –≤–∞—à–µ–≥ MCP —Å–µ—Ä–≤–µ—Ä–∞ —Å–∞ Entra ID: –∫–æ—Ä–∞–∫ –ø–æ –∫–æ—Ä–∞–∫  

–°–∞–¥–∞ —õ–µ–º–æ –ø—Ä–æ—õ–∏ –∫—Ä–æ–∑ –ø—Ä–æ—Ü–µ—Å –æ—Å–∏–≥—É—Ä–∞—ö–∞ –ª–æ–∫–∞–ª–Ω–æ–≥ MCP —Å–µ—Ä–≤–µ—Ä–∞ (–∫–æ—ò–∏ –∫–æ–º—É–Ω–∏—Ü–∏—Ä–∞ –ø—Ä–µ–∫–æ `stdio`) –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ Entra ID. –û–≤–∞—ò –ø—Ä–∏–º–µ—Ä –∫–æ—Ä–∏—Å—Ç–∏ **—ò–∞–≤–Ω–æ–≥ –∫–ª–∏—ò–µ–Ω—Ç–∞**, —à—Ç–æ —ò–µ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ –∑–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ –∫–æ—ò–µ —Ä–∞–¥–µ –Ω–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ–≤–æ–º —Ä–∞—á—É–Ω–∞—Ä—É, –∫–∞–æ —à—Ç–æ —Å—É –¥–µ—Å–∫—Ç–æ–ø –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ –∏–ª–∏ –ª–æ–∫–∞–ª–Ω–∏ —Ä–∞–∑–≤–æ—ò–Ω–∏ —Å–µ—Ä–≤–µ—Ä.

### –°—Ü–µ–Ω–∞—Ä–∏–æ 1: –û—Å–∏–≥—É—Ä–∞—ö–µ –ª–æ–∫–∞–ª–Ω–æ–≥ MCP —Å–µ—Ä–≤–µ—Ä–∞ (—Å–∞ —ò–∞–≤–Ω–∏–º –∫–ª–∏—ò–µ–Ω—Ç–æ–º)  

–£ –æ–≤–æ–º —Å—Ü–µ–Ω–∞—Ä–∏—ò—É, –ø–æ–≥–ª–µ–¥–∞—õ–µ–º–æ MCP —Å–µ—Ä–≤–µ—Ä –∫–æ—ò–∏ —Ä–∞–¥–∏ –ª–æ–∫–∞–ª–Ω–æ, –∫–æ–º—É–Ω–∏—Ü–∏—Ä–∞ –ø—Ä–µ–∫–æ `stdio` –∏ –∫–æ—Ä–∏—Å—Ç–∏ Entra ID –∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É –∫–æ—Ä–∏—Å–Ω–∏–∫–∞ –ø—Ä–µ –Ω–µ–≥–æ —à—Ç–æ –º—É –¥–æ–∑–≤–æ–ª–∏ –ø—Ä–∏—Å—Ç—É–ø –∞–ª–∞—Ç–∏–º–∞. –°–µ—Ä–≤–µ—Ä —õ–µ –∏–º–∞—Ç–∏ —ò–µ–¥–∞–Ω –∞–ª–∞—Ç –∫–æ—ò–∏ –ø—Ä–µ—É–∑–∏–º–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –æ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–æ–º –ø—Ä–æ—Ñ–∏–ª—É —Å–∞ Microsoft Graph API-—ò–∞.

#### 1. –ü–æ–¥–µ—à–∞–≤–∞—ö–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ —É Entra ID  

–ü—Ä–µ –Ω–µ–≥–æ —à—Ç–æ –ø–æ—á–Ω–µ—Ç–µ —Å–∞ –ø–∏—Å–∞—ö–µ–º –∫–æ–¥–∞, –ø–æ—Ç—Ä–µ–±–Ω–æ —ò–µ –¥–∞ —Ä–µ–≥–∏—Å—Ç—Ä—É—ò–µ—Ç–µ —Å–≤–æ—ò—É –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É —É Microsoft Entra ID. –û–≤–æ –æ–±–∞–≤–µ—à—Ç–∞–≤–∞ Entra ID –æ –≤–∞—à–æ—ò –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∏ –∏ –¥–∞—ò–µ —ò–æ—ò –¥–æ–∑–≤–æ–ª—É –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏ —É—Å–ª—É–≥—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ.

1. –ò–¥–∏—Ç–µ –Ω–∞ **[Microsoft Entra –ø–æ—Ä—Ç–∞–ª](https://entra.microsoft.com/)**.  
2. –û—Ç–≤–æ—Ä–∏—Ç–µ **App registrations** –∏ –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ **New registration**.  
3. –î–∞—ò—Ç–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∏ –∏–º–µ (–Ω–ø—Ä. "My Local MCP Server").  
4. –ó–∞ **Supported account types** –∏–∑–∞–±–µ—Ä–∏—Ç–µ **Accounts in this organizational directory only**.  
5. –ó–∞ –æ–≤–∞—ò –ø—Ä–∏–º–µ—Ä –º–æ–∂–µ—Ç–µ –æ—Å—Ç–∞–≤–∏—Ç–∏ **Redirect URI** –ø—Ä–∞–∑–∞–Ω.  
6. –ö–ª–∏–∫–Ω–∏—Ç–µ **Register**.

–ù–∞–∫–æ–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–µ, –∑–∞–ø–∞–º—Ç–∏—Ç–µ **Application (client) ID** –∏ **Directory (tenant) ID**. –ë–∏—õ–µ –≤–∞–º –ø–æ—Ç—Ä–µ–±–Ω–∏ —É –∫–æ–¥—É.

#### 2. –ö–æ–¥: –ü—Ä–µ–≥–ª–µ–¥  

–ü–æ–≥–ª–µ–¥–∞—ò–º–æ –∫—ô—É—á–Ω–µ –¥–µ–ª–æ–≤–µ –∫–æ–¥–∞ –∫–æ—ò–∏ –æ–±—Ä–∞—í—É—ò—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É. –¶–µ–æ –∫–æ–¥ –∑–∞ –æ–≤–∞—ò –ø—Ä–∏–º–µ—Ä –¥–æ—Å—Ç—É–ø–∞–Ω —ò–µ —É —Ñ–∞—Å—Ü–∏–∫–ª–∏ [Entra ID - Local - WAM](https://github.com/Azure-Samples/mcp-auth-servers/tree/main/src/entra-id-local-wam) —É [mcp-auth-servers GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—ò—É–º—É](https://github.com/Azure-Samples/mcp-auth-servers).

**`AuthenticationService.cs`**

–û–≤–∞ –∫–ª–∞—Å–∞ —ò–µ –æ–¥–≥–æ–≤–æ—Ä–Ω–∞ –∑–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ü–∏—ò—É —Å–∞ Entra ID.

- **`CreateAsync`**: –û–≤–∞ –º–µ—Ç–æ–¥–∞ –∏–Ω–∏—Ü–∏—ò–∞–ª–∏–∑—É—ò–µ `PublicClientApplication` –∏–∑ MSAL-–∞. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Å–∞–Ω–∞ —ò–µ —Å–∞ `clientId` –∏ `tenantId` –≤–∞—à–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ.  
- **`WithBroker`**: –û–º–æ–≥—É—õ–∞–≤–∞ –∫–æ—Ä–∏—à—õ–µ—ö–µ –±—Ä–æ–∫–µ—Ä–∞ (–Ω–ø—Ä. Windows Web Account Manager), –∫–æ—ò–∏ –ø—Ä—É–∂–∞ –±–µ–∑–±–µ–¥–Ω–∏—ò–µ –∏ –≥–ª–∞—Ç–∫–æ –∏—Å–∫—É—Å—Ç–≤–æ —ò–µ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–µ –ø—Ä–∏—ò–∞–≤–µ.  
- **`AcquireTokenAsync`**: –û–≤–æ —ò–µ –∫—ô—É—á–Ω–∞ –º–µ—Ç–æ–¥–∞. –ü—Ä–≤–æ –ø–æ–∫—É—à–∞–≤–∞ –¥–∞ —Ç–∏—Ö–æ –¥–æ–±–∏—ò–µ —Ç–æ–∫–µ–Ω (–∫–æ—Ä–∏—Å–Ω–∏–∫ –Ω–µ –º–æ—Ä–∞ –ø–æ–Ω–æ–≤–æ –¥–∞ —Å–µ –ø—Ä–∏—ò–∞–≤—ô—É—ò–µ –∞–∫–æ –≤–µ—õ –∏–º–∞ –≤–∞–ª–∏–¥–Ω—É —Å–µ—Å–∏—ò—É). –ê–∫–æ —Ç–∏—Ö–∏ –ø—Ä–∏—Å—Ç—É–ø –Ω–∏—ò–µ –º–æ–≥—É—õ, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ —õ–µ —Ç—Ä–∞–∂–∏—Ç–∏ –æ–¥ –∫–æ—Ä–∏—Å–Ω–∏–∫–∞ –¥–∞ —Å–µ –ø—Ä–∏—ò–∞–≤–∏.

```csharp
// Simplified for clarity
public static async Task<AuthenticationService> CreateAsync(ILogger<AuthenticationService> logger)
{
    var msalClient = PublicClientApplicationBuilder
        .Create(_clientId) // Your Application (client) ID
        .WithAuthority(AadAuthorityAudience.AzureAdMyOrg)
        .WithTenantId(_tenantId) // Your Directory (tenant) ID
        .WithBroker(new BrokerOptions(BrokerOptions.OperatingSystems.Windows))
        .Build();

    // ... cache registration ...

    return new AuthenticationService(logger, msalClient);
}

public async Task<string> AcquireTokenAsync()
{
    try
    {
        // Try silent authentication first
        var accounts = await _msalClient.GetAccountsAsync();
        var account = accounts.FirstOrDefault();

        AuthenticationResult? result = null;

        if (account != null)
        {
            result = await _msalClient.AcquireTokenSilent(_scopes, account).ExecuteAsync();
        }
        else
        {
            // If no account, or silent fails, go interactive
            result = await _msalClient.AcquireTokenInteractive(_scopes).ExecuteAsync();
        }

        return result.AccessToken;
    }
    catch (Exception ex)
    {
        _logger.LogError(ex, "An error occurred while acquiring the token.");
        throw; // Optionally rethrow the exception for higher-level handling
    }
}
```

**`Program.cs`**

–û–≤–¥–µ —Å–µ –ø–æ–¥–µ—à–∞–≤–∞ MCP —Å–µ—Ä–≤–µ—Ä –∏ –∏–Ω—Ç–µ–≥—Ä–∏—à–µ —Å–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ.

- **`AddSingleton<AuthenticationService>`**: –†–µ–≥–∏—Å—Ç—Ä—É—ò–µ `AuthenticationService` —É dependency injection –∫–æ–Ω—Ç–µ—ò–Ω–µ—Ä—É, —Ç–∞–∫–æ –¥–∞ –≥–∞ –º–æ–≥—É –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –¥—Ä—É–≥–∏ –¥–µ–ª–æ–≤–∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ (–Ω–ø—Ä. –Ω–∞—à –∞–ª–∞—Ç).  
- **`GetUserDetailsFromGraph` –∞–ª–∞—Ç**: –û–≤–∞—ò –∞–ª–∞—Ç –∑–∞—Ö—Ç–µ–≤–∞ –∏–Ω—Å—Ç–∞–Ω—Ü—É `AuthenticationService`. –ü—Ä–µ –Ω–µ–≥–æ —à—Ç–æ –±–∏–ª–æ —à—Ç–∞ —É—Ä–∞–¥–∏, –ø–æ–∑–∏–≤–∞ `authService.AcquireTokenAsync()` –¥–∞ –¥–æ–±–∏—ò–µ –≤–∞–ª–∏–¥–∞–Ω access token. –ê–∫–æ —ò–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ —É—Å–ø–µ—à–Ω–∞, –∫–æ—Ä–∏—Å—Ç–∏ —Ç–æ–∫–µ–Ω –¥–∞ –ø–æ–∑–æ–≤–µ Microsoft Graph API –∏ –ø—Ä–µ—É–∑–º–µ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–µ –ø–æ–¥–∞—Ç–∫–µ.

```csharp
// Simplified for clarity
[McpServerTool(Name = "GetUserDetailsFromGraph")]
public static async Task<string> GetUserDetailsFromGraph(
    AuthenticationService authService)
{
    try
    {
        // This will trigger the authentication flow
        var accessToken = await authService.AcquireTokenAsync();

        // Use the token to create a GraphServiceClient
        var graphClient = new GraphServiceClient(
            new BaseBearerTokenAuthenticationProvider(new TokenProvider(authService)));

        var user = await graphClient.Me.GetAsync();

        return System.Text.Json.JsonSerializer.Serialize(user);
    }
    catch (Exception ex)
    {
        return $"Error: {ex.Message}";
    }
}
```

#### 3. –ö–∞–∫–æ —Å–≤–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—à–µ –∑–∞—ò–µ–¥–Ω–æ  

1. –ö–∞–¥–∞ MCP –∫–ª–∏—ò–µ–Ω—Ç –ø–æ–∫—É—à–∞ –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏ –∞–ª–∞—Ç `GetUserDetailsFromGraph`, –∞–ª–∞—Ç –ø—Ä–≤–æ –ø–æ–∑–∏–≤–∞ `AcquireTokenAsync`.  
2. `AcquireTokenAsync` –ø–æ–∫—Ä–µ—õ–µ MSAL –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–∞ –ø—Ä–æ–≤–µ—Ä–∏ –¥–∞ –ª–∏ –ø–æ—Å—Ç–æ—ò–∏ –≤–∞–ª–∏–¥–∞–Ω —Ç–æ–∫–µ–Ω.  
3. –ê–∫–æ —Ç–æ–∫–µ–Ω –Ω–∏—ò–µ –ø—Ä–æ–Ω–∞—í–µ–Ω, MSAL –ø—Ä–µ–∫–æ –±—Ä–æ–∫–µ—Ä–∞ —Ç—Ä–∞–∂–∏ –æ–¥ –∫–æ—Ä–∏—Å–Ω–∏–∫–∞ –¥–∞ —Å–µ –ø—Ä–∏—ò–∞–≤–∏ —Å–∞ —Å–≤–æ—ò–∏–º Entra ID –Ω–∞–ª–æ–≥–æ–º.  
4. –ö–∞–¥–∞ —Å–µ –∫–æ—Ä–∏—Å–Ω–∏–∫ –ø—Ä–∏—ò–∞–≤–∏, Entra ID –∏–∑–¥–∞—ò–µ access token.  
5. –ê–ª–∞—Ç –¥–æ–±–∏—ò–∞ —Ç–æ–∫–µ–Ω –∏ –∫–æ—Ä–∏—Å—Ç–∏ –≥–∞ –∑–∞ –±–µ–∑–±–µ–¥–∞–Ω –ø–æ–∑–∏–≤ Microsoft Graph API-—ò—É.  
6. –ö–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –ø–æ–¥–∞—Ü–∏ —Å–µ –≤—Ä–∞—õ–∞—ò—É MCP –∫–ª–∏—ò–µ–Ω—Ç—É.

–û–≤–∞—ò –ø—Ä–æ—Ü–µ—Å –æ—Å–∏–≥—É—Ä–∞–≤–∞ –¥–∞ —Å–∞–º–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–æ–≤–∞–Ω–∏ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏ –º–æ–≥—É –¥–∞ –∫–æ—Ä–∏—Å—Ç–µ –∞–ª–∞—Ç, –µ—Ñ–∏–∫–∞—Å–Ω–æ —à—Ç–∏—Ç–µ—õ–∏ –≤–∞—à –ª–æ–∫–∞–ª–Ω–∏ MCP —Å–µ—Ä–≤–µ—Ä.

### –°—Ü–µ–Ω–∞—Ä–∏–æ 2: –û—Å–∏–≥—É—Ä–∞—ö–µ —É–¥–∞—ô–µ–Ω–æ–≥ MCP —Å–µ—Ä–≤–µ—Ä–∞ (—Å–∞ –ø–æ–≤–µ—Ä—ô–∏–≤–∏–º –∫–ª–∏—ò–µ–Ω—Ç–æ–º)  

–ö–∞–¥–∞ –≤–∞—à MCP —Å–µ—Ä–≤–µ—Ä —Ä–∞–¥–∏ –Ω–∞ —É–¥–∞—ô–µ–Ω–æ—ò –º–∞—à–∏–Ω–∏ (–Ω–ø—Ä. cloud —Å–µ—Ä–≤–µ—Ä—É) –∏ –∫–æ–º—É–Ω–∏—Ü–∏—Ä–∞ –ø—Ä–µ–∫–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∫–∞–æ —à—Ç–æ —ò–µ HTTP Streaming, –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∏ –∑–∞—Ö—Ç–µ–≤–∏ —Å—É –¥—Ä—É–≥–∞—á–∏—ò–∏. –£ –æ–≤–æ–º —Å–ª—É—á–∞—ò—É —Ç—Ä–µ–±–∞ –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ **–ø–æ–≤–µ—Ä—ô–∏–≤–æ–≥ –∫–ª–∏—ò–µ–Ω—Ç–∞** –∏ **Authorization Code Flow**. –û–≤–æ —ò–µ –±–µ–∑–±–µ–¥–Ω–∏—ò–∞ –º–µ—Ç–æ–¥–∞ —ò–µ—Ä —Å–µ —Ç–∞—ò–Ω–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ –Ω–∏–∫–∞–¥–∞ –Ω–µ –∏–∑–ª–∞–∂—É –ø—Ä–µ–≥–ª–µ–¥–∞—á—É.

–û–≤–∞—ò –ø—Ä–∏–º–µ—Ä –∫–æ—Ä–∏—Å—Ç–∏ TypeScript –±–∞–∑–∏—Ä–∞–Ω MCP —Å–µ—Ä–≤–µ—Ä –∫–æ—ò–∏ –∫–æ—Ä–∏—Å—Ç–∏ Express.js –∑–∞ —Ä—É–∫–æ–≤–∞—ö–µ HTTP –∑–∞—Ö—Ç–µ–≤–∏–º–∞.

#### 1. –ü–æ–¥–µ—à–∞–≤–∞—ö–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ —É Entra ID  

–ü–æ–¥–µ—à–∞–≤–∞—ö–µ —É Entra ID —ò–µ —Å–ª–∏—á–Ω–æ –∫–∞–æ –∫–æ–¥ —ò–∞–≤–Ω–æ–≥ –∫–ª–∏—ò–µ–Ω—Ç–∞, –∞–ª–∏ —Å–∞ —ò–µ–¥–Ω–æ–º –∫—ô—É—á–Ω–æ–º —Ä–∞–∑–ª–∏–∫–æ–º: –ø–æ—Ç—Ä–µ–±–Ω–æ —ò–µ –¥–∞ –∫—Ä–µ–∏—Ä–∞—Ç–µ **client secret**.

1. –ò–¥–∏—Ç–µ –Ω–∞ **[Microsoft Entra –ø–æ—Ä—Ç–∞–ª](https://entra.microsoft.com/)**.  
2. –£ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ –∏–¥–∏—Ç–µ –Ω–∞ —Ç–∞–± **Certificates & secrets**.  
3. –ö–ª–∏–∫–Ω–∏—Ç–µ **New client secret**, –¥–∞—ò—Ç–µ –æ–ø–∏—Å –∏ –∫–ª–∏–∫–Ω–∏—Ç–µ **Add**.  
4. **–í–∞–∂–Ω–æ:** –û–¥–º–∞—Ö –∫–æ–ø–∏—Ä–∞—ò—Ç–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç —Ç–∞—ò–Ω–µ. –ù–∞–∫–æ–Ω —Ç–æ–≥–∞ –Ω–µ—õ–µ—Ç–µ –º–æ—õ–∏ –ø–æ–Ω–æ–≤–æ –¥–∞ —ò–µ –≤–∏–¥–∏—Ç–µ.  
5. –¢–∞–∫–æ—í–µ –º–æ—Ä–∞—Ç–µ –¥–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—à–µ—Ç–µ **Redirect URI**. –ò–¥–∏—Ç–µ –Ω–∞ —Ç–∞–± **Authentication**, –∫–ª–∏–∫–Ω–∏—Ç–µ **Add a platform**, –∏–∑–∞–±–µ—Ä–∏—Ç–µ **Web** –∏ —É–Ω–µ—Å–∏—Ç–µ redirect URI –∑–∞ –≤–∞—à—É –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É (–Ω–ø—Ä. `http://localhost:3001/auth/callback`).

> **‚ö†Ô∏è –í–∞–∂–Ω–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∞ –Ω–∞–ø–æ–º–µ–Ω–∞:** –ó–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–æ–Ω–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ, Microsoft —Å–Ω–∞–∂–Ω–æ –ø—Ä–µ–ø–æ—Ä—É—á—É—ò–µ –∫–æ—Ä–∏—à—õ–µ—ö–µ –º–µ—Ç–æ–¥–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ –±–µ–∑ —Ç–∞—ò–Ω–∏ –∫–∞–æ —à—Ç–æ —Å—É **Managed Identity** –∏–ª–∏ **Workload Identity Federation** —É–º–µ—Å—Ç–æ client secrets. Client secrets –Ω–æ—Å–µ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ —Ä–∏–∑–∏–∫–µ —ò–µ—Ä –º–æ–≥—É –±–∏—Ç–∏ –∏–∑–ª–æ–∂–µ–Ω–∏ –∏–ª–∏ –∫–æ–º–ø—Ä–æ–º–∏—Ç–æ–≤–∞–Ω–∏. Managed identities –ø—Ä—É–∂–∞—ò—É –±–µ–∑–±–µ–¥–Ω–∏—ò–∏ –ø—Ä–∏—Å—Ç—É–ø –µ–ª–∏–º–∏–Ω–∏—à—É—õ–∏ –ø–æ—Ç—Ä–µ–±—É –∑–∞ —á—É–≤–∞—ö–µ–º –∞–∫—Ä–µ–¥–∏—Ç–∏–≤–∞ —É –∫–æ–¥—É –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–∏.  
>  
> –ó–∞ –≤–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞ –æ managed identities –∏ –∫–∞–∫–æ –∏—Ö –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—Ç–∏, –ø–æ–≥–ª–µ–¥–∞—ò—Ç–µ [Managed identities for Azure resources overview](https://learn.microsoft.com/entra/identity/managed-identities-azure-resources/overview).

#### 2. –ö–æ–¥: –ü—Ä–µ–≥–ª–µ–¥  

–û–≤–∞—ò –ø—Ä–∏–º–µ—Ä –∫–æ—Ä–∏—Å—Ç–∏ –ø—Ä–∏—Å—Ç—É–ø –∑–∞—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å–µ—Å–∏—ò–∞–º–∞. –ö–∞–¥–∞ —Å–µ –∫–æ—Ä–∏—Å–Ω–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫—É—ò–µ, —Å–µ—Ä–≤–µ—Ä —á—É–≤–∞ access token –∏ refresh token —É —Å–µ—Å–∏—ò–∏ –∏ –¥–∞—ò–µ –∫–æ—Ä–∏—Å–Ω–∏–∫—É session token. –û–≤–∞—ò session token —Å–µ –∑–∞—Ç–∏–º –∫–æ—Ä–∏—Å—Ç–∏ –∑–∞ –Ω–∞—Ä–µ–¥–Ω–µ –∑–∞—Ö—Ç–µ–≤–µ. –¶–µ–æ –∫–æ–¥ –∑–∞ –æ–≤–∞—ò –ø—Ä–∏–º–µ—Ä –¥–æ—Å—Ç—É–ø–∞–Ω —ò–µ —É —Ñ–∞—Å—Ü–∏–∫–ª–∏ [Entra ID - Confidential client](https://github.com/Azure-Samples/mcp-auth-servers/tree/main/src/entra-id-cca-session) —É [mcp-auth-servers GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—ò—É–º—É](https://github.com/Azure-Samples/mcp-auth-servers).

**`Server.ts`**

–û–≤–∞—ò —Ñ–∞—ò–ª –ø–æ–¥–µ—à–∞–≤–∞ Express —Å–µ—Ä–≤–µ—Ä –∏ MCP transport layer.

- **`requireBearerAuth`**: –û–≤–æ —ò–µ middleware –∫–æ—ò–∏ —à—Ç–∏—Ç–∏ `/sse` –∏ `/message` –∫—Ä–∞—ò—ö–µ —Ç–∞—á–∫–µ. –ü—Ä–æ–≤–µ—Ä–∞–≤–∞ –≤–∞–ª–∏–¥–∞–Ω bearer token —É `Authorization` –∑–∞–≥–ª–∞–≤—ô—É –∑–∞—Ö—Ç–µ–≤–∞.  
- **`EntraIdServerAuthProvider`**: –û–≤–æ —ò–µ –ø—Ä–∏–ª–∞–≥–æ—í–µ–Ω–∞ –∫–ª–∞—Å–∞ –∫–æ—ò–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ—ò—Å `McpServerAuthorizationProvider`. –û–¥–≥–æ–≤–æ—Ä–Ω–∞ —ò–µ –∑–∞ —Ä—É–∫–æ–≤–∞—ö–µ OAuth 2.0 —Ç–æ–∫–æ–º.  
- **`/auth/callback`**: –û–≤–∞ –∫—Ä–∞—ò—ö–∞ —Ç–∞—á–∫–∞ –æ–±—Ä–∞—í—É—ò–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å–∞ Entra ID –Ω–∞–∫–æ–Ω —à—Ç–æ —Å–µ –∫–æ—Ä–∏—Å–Ω–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫—É—ò–µ. –†–∞–∑–º–µ—ö—É—ò–µ authorization code –∑–∞ access token –∏ refresh token.

```typescript
// Simplified for clarity
const app = express();
const { server } = createServer();
const provider = new EntraIdServerAuthProvider();

// Protect the SSE endpoint
app.get("/sse", requireBearerAuth({
  provider,
  requiredScopes: ["User.Read"]
}), async (req, res) => {
  // ... connect to the transport ...
});

// Protect the message endpoint
app.post("/message", requireBearerAuth({
  provider,
  requiredScopes: ["User.Read"]
}), async (req, res) => {
  // ... handle the message ...
});

// Handle the OAuth 2.0 callback
app.get("/auth/callback", (req, res) => {
  provider.handleCallback(req.query.code, req.query.state)
    .then(result => {
      // ... handle success or failure ...
    });
});
```

**`Tools.ts`**

–û–≤–∞—ò —Ñ–∞—ò–ª –¥–µ—Ñ–∏–Ω–∏—à–µ –∞–ª–∞—Ç–µ –∫–æ—ò–µ MCP —Å–µ—Ä–≤–µ—Ä –ø—Ä—É–∂–∞. –ê–ª–∞—Ç `getUserDetails` —ò–µ —Å–ª–∏—á–∞–Ω –æ–Ω–æ–º –∏–∑ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ–≥ –ø—Ä–∏–º–µ—Ä–∞, –∞–ª–∏ –¥–æ–±–∏—ò–∞ access token –∏–∑ —Å–µ—Å–∏—ò–µ.

```typescript
// Simplified for clarity
server.setRequestHandler(CallToolRequestSchema, async (request) => {
  const { name } = request.params;
  const context = request.params?.context as { token?: string } | undefined;
  const sessionToken = context?.token;

  if (name === ToolName.GET_USER_DETAILS) {
    if (!sessionToken) {
      throw new AuthenticationError("Authentication token is missing or invalid. Ensure the token is provided in the request context.");
    }

    // Get the Entra ID token from the session store
    const tokenData = tokenStore.getToken(sessionToken);
    const entraIdToken = tokenData.accessToken;

    const graphClient = Client.init({
      authProvider: (done) => {
        done(null, entraIdToken);
      }
    });

    const user = await graphClient.api('/me').get();

    // ... return user details ...
  }
});
```

**`auth/EntraIdServerAuthProvider.ts`**

–û–≤–∞ –∫–ª–∞—Å–∞ –æ–±—Ä–∞—í—É—ò–µ –ª–æ–≥–∏–∫—É –∑–∞:

- –†–µ–¥–∏—Ä–µ–∫—Ç–æ–≤–∞—ö–µ –∫–æ—Ä–∏—Å–Ω–∏–∫–∞ –Ω–∞ Entra ID —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞ –ø—Ä–∏—ò–∞–≤—É.  
- –†–∞–∑–º–µ–Ω—É authorization code –∑–∞ access token.  
- –ß—É–≤–∞—ö–µ —Ç–æ–∫–µ–Ω–∞ —É `tokenStore`.  
- –û—Å–≤–µ–∂–∞–≤–∞—ö–µ access token-–∞ –∫–∞–¥–∞ –∏—Å—Ç–µ–∫–Ω–µ.

#### 3. –ö–∞–∫–æ —Å–≤–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—à–µ –∑–∞—ò–µ–¥–Ω–æ  

1. –ö–∞–¥–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫ –ø—Ä–≤–∏ –ø—É—Ç –ø–æ–∫—É—à–∞ –¥–∞ —Å–µ –ø–æ–≤–µ–∂–µ –Ω–∞ MCP —Å–µ—Ä–≤–µ—Ä, `requireBearerAuth` middleware —õ–µ —É–æ—á–∏—Ç–∏ –¥–∞ –Ω–µ–º–∞ –≤–∞–ª–∏–¥–Ω—É —Å–µ—Å–∏—ò—É –∏ –ø—Ä–µ—É—Å–º–µ—Ä–∏—õ–µ –≥–∞ –Ω–∞ Entra ID —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞ –ø—Ä–∏—ò–∞–≤—É.  
2. –ö–æ—Ä–∏—Å–Ω–∏–∫ —Å–µ –ø—Ä–∏—ò–∞–≤—ô—É—ò–µ —Å–∞ —Å–≤–æ—ò–∏–º Entra ID –Ω–∞–ª–æ–≥–æ–º.  
3. Entra ID –ø—Ä–µ—É—Å–º–µ—Ä–∞–≤–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–∞ –Ω–∞–∑–∞–¥ –Ω–∞ `/auth/callback`
4. –°–µ—Ä–≤–µ—Ä —Ä–∞–∑–º–µ—ö—É—ò–µ –∫–æ–¥ –∑–∞ access token –∏ refresh token, —á—É–≤–∞ –∏—Ö –∏ –∫—Ä–µ–∏—Ä–∞ session token –∫–æ—ò–∏ —Å–µ —à–∞—ô–µ –∫–ª–∏—ò–µ–Ω—Ç—É.  
5. –ö–ª–∏—ò–µ–Ω—Ç —Å–∞–¥–∞ –º–æ–∂–µ –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏ –æ–≤–∞—ò session token —É `Authorization` –∑–∞–≥–ª–∞–≤—ô—É –∑–∞ —Å–≤–µ –±—É–¥—É—õ–µ –∑–∞—Ö—Ç–µ–≤–µ –∫–∞ MCP —Å–µ—Ä–≤–µ—Ä—É.  
6. –ö–∞–¥–∞ —Å–µ –ø–æ–∑–æ–≤–µ –∞–ª–∞—Ç `getUserDetails`, –æ–Ω –∫–æ—Ä–∏—Å—Ç–∏ session token –¥–∞ –ø—Ä–æ–Ω–∞—í–µ Entra ID access token, –∞ –∑–∞—Ç–∏–º –≥–∞ –∫–æ—Ä–∏—Å—Ç–∏ –∑–∞ –ø–æ–∑–∏–≤ Microsoft Graph API-—ò–∞.

–û–≤–∞—ò —Ç–æ–∫ —ò–µ —Å–ª–æ–∂–µ–Ω–∏—ò–∏ –æ–¥ public client —Ç–æ–∫–∞, –∞–ª–∏ —ò–µ –Ω–µ–æ–ø—Ö–æ–¥–∞–Ω –∑–∞ endpoint-–æ–≤–µ –∫–æ—ò–∏ —Å—É –∏–∑–ª–æ–∂–µ–Ω–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –ü–æ—à—Ç–æ —Å—É —É–¥–∞—ô–µ–Ω–∏ MCP —Å–µ—Ä–≤–µ—Ä–∏ –¥–æ—Å—Ç—É–ø–Ω–∏ –ø—Ä–µ–∫–æ —ò–∞–≤–Ω–æ–≥ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, –ø–æ—Ç—Ä–µ–±–Ω–µ —Å—É —ò–∞—á–µ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ –º–µ—Ä–µ –∫–∞–∫–æ –±–∏ —Å–µ –∑–∞—à—Ç–∏—Ç–∏–ª–∏ –æ–¥ –Ω–µ–æ–≤–ª–∞—à—õ–µ–Ω–æ–≥ –ø—Ä–∏—Å—Ç—É–ø–∞ –∏ –ø–æ—Ç–µ–Ω—Ü–∏—ò–∞–ª–Ω–∏—Ö –Ω–∞–ø–∞–¥–∞.


## –ù–∞—ò–±–æ—ô–µ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ –ø—Ä–∞–∫—Å–µ

- **–£–≤–µ–∫ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ HTTPS**: –ï–Ω–∫—Ä–∏–ø—Ç—É—ò—Ç–µ –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—ò—É –∏–∑–º–µ—í—É –∫–ª–∏—ò–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞ –∫–∞–∫–æ –±–∏—Å—Ç–µ –∑–∞—à—Ç–∏—Ç–∏–ª–∏ —Ç–æ–∫–µ–Ω–µ –æ–¥ –ø—Ä–µ—Å—Ä–µ—Ç–∞—ö–∞.  
- **–ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—ò—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—É –ø—Ä–∏—Å—Ç—É–ø–∞ –∑–∞—Å–Ω–æ–≤–∞–Ω—É –Ω–∞ —É–ª–æ–≥–∞–º–∞ (RBAC)**: –ù–µ –ø—Ä–æ–≤–µ—Ä–∞–≤–∞—ò—Ç–µ —Å–∞–º–æ *–¥–∞ –ª–∏* —ò–µ –∫–æ—Ä–∏—Å–Ω–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–æ–≤–∞–Ω, –≤–µ—õ –∏ *—à—Ç–∞* –º—É —ò–µ –¥–æ–∑–≤–æ—ô–µ–Ω–æ –¥–∞ —Ä–∞–¥–∏. –ú–æ–∂–µ—Ç–µ –¥–µ—Ñ–∏–Ω–∏—Å–∞—Ç–∏ —É–ª–æ–≥–µ —É Entra ID-—É –∏ –ø—Ä–æ–≤–µ—Ä–∞–≤–∞—Ç–∏ –∏—Ö –Ω–∞ –≤–∞—à–µ–º MCP —Å–µ—Ä–≤–µ—Ä—É.  
- **–ü—Ä–∞—Ç–∏—Ç–µ –∏ —Ä–µ–≤–∏–¥–∏—Ä–∞—ò—Ç–µ**: –õ–æ–≥–æ–≤–∞—ò—Ç–µ —Å–≤–µ –¥–æ–≥–∞—í–∞—ò–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ –∫–∞–∫–æ –±–∏—Å—Ç–µ –º–æ–≥–ª–∏ –¥–∞ –æ—Ç–∫—Ä–∏—ò–µ—Ç–µ –∏ —Ä–µ–∞–≥—É—ò–µ—Ç–µ –Ω–∞ —Å—É–º—ö–∏–≤–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.  
- **–û–±—Ä–∞–¥–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ—ö–∞ –±—Ä–æ—ò–∞ –∑–∞—Ö—Ç–µ–≤–∞ –∏ —É—Å–ø–æ—Ä–∞–≤–∞—ö–µ (rate limiting –∏ throttling)**: Microsoft Graph –∏ –¥—Ä—É–≥–∏ API-—ò–∏ –ø—Ä–∏–º–µ—ö—É—ò—É rate limiting –¥–∞ —Å–ø—Ä–µ—á–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±—É. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—ò—Ç–µ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏—ò–∞–ª–Ω–æ –æ–¥–ª–∞–≥–∞—ö–µ –∏ –ª–æ–≥–∏–∫—É –ø–æ–Ω–æ–≤–Ω–æ–≥ –ø–æ–∫—É—à–∞—ò–∞ —É –≤–∞—à–µ–º MCP —Å–µ—Ä–≤–µ—Ä—É –∫–∞–∫–æ –±–∏—Å—Ç–µ –ª–µ–ø–æ –æ–±—Ä–∞–¥–∏–ª–∏ HTTP 429 (Too Many Requests) –æ–¥–≥–æ–≤–æ—Ä–µ. –†–∞–∑–º–æ—Ç—Ä–∏—Ç–µ –∫–µ—à–∏—Ä–∞—ö–µ —á–µ—Å—Ç–æ –ø—Ä–∏—Å—Ç—É–ø–∞–Ω–∏—Ö –ø–æ–¥–∞—Ç–∞–∫–∞ –¥–∞ –±–∏—Å—Ç–µ —Å–º–∞—ö–∏–ª–∏ –±—Ä–æ—ò API –ø–æ–∑–∏–≤–∞.  
- **–ë–µ–∑–±–µ–¥–Ω–æ —á—É–≤–∞—ö–µ —Ç–æ–∫–µ–Ω–∞**: –ß—É–≤–∞—ò—Ç–µ access –∏ refresh —Ç–æ–∫–µ–Ω–µ –Ω–∞ –±–µ–∑–±–µ–¥–∞–Ω –Ω–∞—á–∏–Ω. –ó–∞ –ª–æ–∫–∞–ª–Ω–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—Å–∫–µ –º–µ—Ö–∞–Ω–∏–∑–º–µ –∑–∞ –±–µ–∑–±–µ–¥–Ω–æ —Å–∫–ª–∞–¥–∏—à—Ç–µ—ö–µ. –ó–∞ —Å–µ—Ä–≤–µ—Ä—Å–∫–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ —Ä–∞–∑–º–∏—Å–ª–∏—Ç–µ –æ –∫–æ—Ä–∏—à—õ–µ—ö—É –µ–Ω–∫—Ä–∏–ø—Ç–æ–≤–∞–Ω–æ–≥ —Å–∫–ª–∞–¥–∏—à—Ç–∞ –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–∞ –∑–∞ —É–ø—Ä–∞–≤—ô–∞—ö–µ –∫—ô—É—á–µ–≤–∏–º–∞ –∫–∞–æ —à—Ç–æ —ò–µ Azure Key Vault.  
- **–û–±—Ä–∞–¥–∞ –∏—Å—Ç–µ–∫–∞ —Ç–æ–∫–µ–Ω–∞**: Access —Ç–æ–∫–µ–Ω–∏ –∏–º–∞—ò—É –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Ä–æ–∫ —Ç—Ä–∞—ò–∞—ö–∞. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—ò—Ç–µ –∞—É—Ç–æ–º–∞—Ç—Å–∫–æ –æ—Å–≤–µ–∂–∞–≤–∞—ö–µ —Ç–æ–∫–µ–Ω–∞ –∫–æ—Ä–∏—à—õ–µ—ö–µ–º refresh —Ç–æ–∫–µ–Ω–∞ –∫–∞–∫–æ –±–∏—Å—Ç–µ –æ–±–µ–∑–±–µ–¥–∏–ª–∏ –Ω–µ–ø—Ä–µ–∫–∏–¥–∞–Ω –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–∂–∏–≤—ô–∞—ò –±–µ–∑ –ø–æ—Ç—Ä–µ–±–µ –∑–∞ –ø–æ–Ω–æ–≤–Ω–æ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–æ–º.  
- **–†–∞–∑–º–æ—Ç—Ä–∏—Ç–µ –∫–æ—Ä–∏—à—õ–µ—ö–µ Azure API Management-–∞**: –ò–∞–∫–æ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ —É –≤–∞—à–µ–º MCP —Å–µ—Ä–≤–µ—Ä—É –ø—Ä—É–∂–∞ —Ñ–∏–Ω—É –∫–æ–Ω—Ç—Ä–æ–ª—É, API Gateway-—ò–∏ –∫–∞–æ —à—Ç–æ —ò–µ Azure API Management –º–æ–≥—É –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ —Ä–µ—à–∞–≤–∞—Ç–∏ –º–Ω–æ–≥–µ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ –∏–∑–∞–∑–æ–≤–µ, —É–∫—ô—É—á—É—ò—É—õ–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É, –∞—É—Ç–æ—Ä–∏–∑–∞—Ü–∏—ò—É, rate limiting –∏ –ø—Ä–∞—õ–µ—ö–µ. –û–Ω–∏ –ø—Ä—É–∂–∞—ò—É —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∏—Ä–∞–Ω —Å–ª–æ—ò –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç–∏ –∏–∑–º–µ—í—É –≤–∞—à–∏—Ö –∫–ª–∏—ò–µ–Ω–∞—Ç–∞ –∏ MCP —Å–µ—Ä–≤–µ—Ä–∞. –ó–∞ –≤–∏—à–µ –¥–µ—Ç–∞—ô–∞ –æ –∫–æ—Ä–∏—à—õ–µ—ö—É API Gateway-—ò–∞ —Å–∞ MCP, –ø–æ–≥–ª–µ–¥–∞—ò—Ç–µ –Ω–∞—à [Azure API Management Your Auth Gateway For MCP Servers](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690).


## –ö—ô—É—á–Ω–µ –ø–æ—É–∫–µ

- –ó–∞—à—Ç–∏—Ç–∞ –≤–∞—à–µ–≥ MCP —Å–µ—Ä–≤–µ—Ä–∞ —ò–µ –∫—ô—É—á–Ω–∞ –∑–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç –≤–∞—à–∏—Ö –ø–æ–¥–∞—Ç–∞–∫–∞ –∏ –∞–ª–∞—Ç–∞.  
- Microsoft Entra ID –ø—Ä—É–∂–∞ —Ä–æ–±—É—Å–Ω–æ –∏ —Å–∫–∞–ª–∞–±–∏–ª–Ω–æ —Ä–µ—à–µ—ö–µ –∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É –∏ –∞—É—Ç–æ—Ä–∏–∑–∞—Ü–∏—ò—É.  
- –ö–æ—Ä–∏—Å—Ç–∏—Ç–µ **public client** –∑–∞ –ª–æ–∫–∞–ª–Ω–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ –∏ **confidential client** –∑–∞ —É–¥–∞—ô–µ–Ω–µ —Å–µ—Ä–≤–µ—Ä–µ.  
- **Authorization Code Flow** —ò–µ –Ω–∞—ò—Å–∏–≥—É—Ä–Ω–∏—ò–∞ –æ–ø—Ü–∏—ò–∞ –∑–∞ –≤–µ–± –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ.


## –í–µ–∂–±–∞

1. –†–∞–∑–º–∏—Å–ª–∏—Ç–µ –æ MCP —Å–µ—Ä–≤–µ—Ä—É –∫–æ—ò–∏ –±–∏—Å—Ç–µ –º–æ–≥–ª–∏ –Ω–∞–ø—Ä–∞–≤–∏—Ç–∏. –î–∞ –ª–∏ –±–∏ —Ç–æ –±–∏–æ –ª–æ–∫–∞–ª–Ω–∏ –∏–ª–∏ —É–¥–∞—ô–µ–Ω–∏ —Å–µ—Ä–≤–µ—Ä?  
2. –ù–∞ –æ—Å–Ω–æ–≤—É –æ–¥–≥–æ–≤–æ—Ä–∞, –¥–∞ –ª–∏ –±–∏—Å—Ç–µ –∫–æ—Ä–∏—Å—Ç–∏–ª–∏ public –∏–ª–∏ confidential client?  
3. –ö–æ—ò–µ –¥–æ–∑–≤–æ–ª–µ –±–∏ –≤–∞—à MCP —Å–µ—Ä–≤–µ—Ä —Ç—Ä–∞–∂–∏–æ –∑–∞ –∏–∑–≤—Ä—à–∞–≤–∞—ö–µ —Ä–∞–¥—ö–∏ –ø—Ä–µ–º–∞ Microsoft Graph-—É?


## –ü—Ä–∞–∫—Ç–∏—á–Ω–µ –≤–µ–∂–±–µ

### –í–µ–∂–±–∞ 1: –†–µ–≥–∏—Å—Ç—Ä—É—ò—Ç–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É —É Entra ID  
–ò–¥–∏—Ç–µ –Ω–∞ Microsoft Entra –ø–æ—Ä—Ç–∞–ª.  
–†–µ–≥–∏—Å—Ç—Ä—É—ò—Ç–µ –Ω–æ–≤—É –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É –∑–∞ –≤–∞—à MCP —Å–µ—Ä–≤–µ—Ä.  
–ó–∞–±–µ–ª–µ–∂–∏—Ç–µ Application (client) ID –∏ Directory (tenant) ID.

### –í–µ–∂–±–∞ 2: –û—Å–∏–≥—É—Ä–∞—ò—Ç–µ –ª–æ–∫–∞–ª–Ω–∏ MCP —Å–µ—Ä–≤–µ—Ä (Public Client)  
- –ü—Ä–∞—Ç–∏—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –∑–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—ò—É MSAL (Microsoft Authentication Library) –∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É –∫–æ—Ä–∏—Å–Ω–∏–∫–∞.  
- –¢–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ —Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ –ø–æ–∑–∏–≤–∞—ò—É—õ–∏ MCP –∞–ª–∞—Ç –∫–æ—ò–∏ –ø—Ä–µ—É–∑–∏–º–∞ –¥–µ—Ç–∞—ô–µ –∫–æ—Ä–∏—Å–Ω–∏–∫–∞ –∏–∑ Microsoft Graph-–∞.

### –í–µ–∂–±–∞ 3: –û—Å–∏–≥—É—Ä–∞—ò—Ç–µ —É–¥–∞—ô–µ–Ω–∏ MCP —Å–µ—Ä–≤–µ—Ä (Confidential Client)  
- –†–µ–≥–∏—Å—Ç—Ä—É—ò—Ç–µ confidential client —É Entra ID-—É –∏ –∫—Ä–µ–∏—Ä–∞—ò—Ç–µ client secret.  
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—à–∏—Ç–µ –≤–∞—à Express.js MCP —Å–µ—Ä–≤–µ—Ä –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏ Authorization Code Flow.  
- –¢–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ –∑–∞—à—Ç–∏—õ–µ–Ω–µ endpoint-–æ–≤–µ –∏ –ø–æ—Ç–≤—Ä–¥–∏—Ç–µ –ø—Ä–∏—Å—Ç—É–ø –∑–∞—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ç–æ–∫–µ–Ω—É.

### –í–µ–∂–±–∞ 4: –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –Ω–∞—ò–±–æ—ô–µ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ –ø—Ä–∞–∫—Å–µ  
- –û–º–æ–≥—É—õ–∏—Ç–µ HTTPS –∑–∞ –≤–∞—à –ª–æ–∫–∞–ª–Ω–∏ –∏–ª–∏ —É–¥–∞—ô–µ–Ω–∏ —Å–µ—Ä–≤–µ—Ä.  
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—ò—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—É –ø—Ä–∏—Å—Ç—É–ø–∞ –∑–∞—Å–Ω–æ–≤–∞–Ω—É –Ω–∞ —É–ª–æ–≥–∞–º–∞ (RBAC) —É –ª–æ–≥–∏—Ü–∏ —Å–µ—Ä–≤–µ—Ä–∞.  
- –î–æ–¥–∞—ò—Ç–µ –æ–±—Ä–∞–¥—É –∏—Å—Ç–µ–∫–∞ —Ç–æ–∫–µ–Ω–∞ –∏ –±–µ–∑–±–µ–¥–Ω–æ —á—É–≤–∞—ö–µ —Ç–æ–∫–µ–Ω–∞.

## –†–µ—Å—É—Ä—Å–∏

1. **MSAL Overview Documentation**  
   –°–∞–∑–Ω–∞—ò—Ç–µ –∫–∞–∫–æ Microsoft Authentication Library (MSAL) –æ–º–æ–≥—É—õ–∞–≤–∞ –±–µ–∑–±–µ–¥–Ω–æ –¥–æ–±–∏—ò–∞—ö–µ —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Ä–∞–∑–ª–∏—á–∏—Ç–∏–º –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∞:  
   [MSAL Overview on Microsoft Learn](https://learn.microsoft.com/en-gb/entra/msal/overview)

2. **Azure-Samples/mcp-auth-servers GitHub Repository**  
   –ü—Ä–∏–º–µ—Ä–∏ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞ MCP —Å–µ—Ä–≤–µ—Ä–∞ –∫–æ—ò–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–∞—ò—É —Ç–æ–∫–æ–≤–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ:  
   [Azure-Samples/mcp-auth-servers on GitHub](https://github.com/Azure-Samples/mcp-auth-servers)

3. **Managed Identities for Azure Resources Overview**  
   –°–∞–∑–Ω–∞—ò—Ç–µ –∫–∞–∫–æ –µ–ª–∏–º–∏–Ω–∏—Å–∞—Ç–∏ —Ç–∞—ò–Ω–µ –∫–æ—Ä–∏—à—õ–µ—ö–µ–º —Å–∏—Å—Ç–µ–º—Å–∫–∏ –∏–ª–∏ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–¥–µ—ô–µ–Ω–∏—Ö managed identities:  
   [Managed Identities Overview on Microsoft Learn](https://learn.microsoft.com/en-us/entra/identity/managed-identities-azure-resources/)

4. **Azure API Management: Your Auth Gateway for MCP Servers**  
   –î–µ—Ç–∞—ô–∞–Ω –ø—Ä–µ–≥–ª–µ–¥ –∫–æ—Ä–∏—à—õ–µ—ö–∞ APIM –∫–∞–æ –±–µ–∑–±–µ–¥–Ω–æ–≥ OAuth2 gateway-–∞ –∑–∞ MCP —Å–µ—Ä–≤–µ—Ä–µ:  
   [Azure API Management Your Auth Gateway For MCP Servers](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)

5. **Microsoft Graph Permissions Reference**  
   –ö–æ–º–ø–ª–µ—Ç–Ω–∞ –ª–∏—Å—Ç–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–∏—Ö –∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò—Å–∫–∏—Ö –¥–æ–∑–≤–æ–ª–∞ –∑–∞ Microsoft Graph:  
   [Microsoft Graph Permissions Reference](https://learn.microsoft.com/zh-tw/graph/permissions-reference)


## –†–µ–∑—É–ª—Ç–∞—Ç–∏ —É—á–µ—ö–∞  
–ù–∞–∫–æ–Ω –∑–∞–≤—Ä—à–µ—Ç–∫–∞ –æ–≤–æ–≥ –¥–µ–ª–∞, –º–æ—õ–∏ —õ–µ—Ç–µ –¥–∞:

- –û–±—ò–∞—Å–Ω–∏—Ç–µ –∑–∞—à—Ç–æ —ò–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –∑–∞ MCP —Å–µ—Ä–≤–µ—Ä–µ –∏ AI —Ç–æ–∫–æ–≤–µ —Ä–∞–¥–∞.  
- –ü–æ–¥–µ—Å–∏—Ç–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—à–µ—Ç–µ Entra ID –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É –∑–∞ –ª–æ–∫–∞–ª–Ω–µ –∏ —É–¥–∞—ô–µ–Ω–µ MCP —Å–µ—Ä–≤–µ—Ä–µ.  
- –ò–∑–∞–±–µ—Ä–µ—Ç–µ –æ–¥–≥–æ–≤–∞—Ä–∞—ò—É—õ–∏ —Ç–∏–ø –∫–ª–∏—ò–µ–Ω—Ç–∞ (public –∏–ª–∏ confidential) —É –∑–∞–≤–∏—Å–Ω–æ—Å—Ç–∏ –æ–¥ –æ–∫—Ä—É–∂–µ—ö–∞ —Å–µ—Ä–≤–µ—Ä–∞.  
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—Ç–µ –±–µ–∑–±–µ–¥–Ω–µ –ø—Ä–∞–∫—Å–µ –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–∞—ö–∞, —É–∫—ô—É—á—É—ò—É—õ–∏ —á—É–≤–∞—ö–µ —Ç–æ–∫–µ–Ω–∞ –∏ –∞—É—Ç–æ—Ä–∏–∑–∞—Ü–∏—ò—É –∑–∞—Å–Ω–æ–≤–∞–Ω—É –Ω–∞ —É–ª–æ–≥–∞–º–∞.  
- –°–∞ —Å–∏–≥—É—Ä–Ω–æ—à—õ—É –∑–∞—à—Ç–∏—Ç–∏—Ç–µ –≤–∞—à MCP —Å–µ—Ä–≤–µ—Ä –∏ —ö–µ–≥–æ–≤–µ –∞–ª–∞—Ç–µ –æ–¥ –Ω–µ–æ–≤–ª–∞—à—õ–µ–Ω–æ–≥ –ø—Ä–∏—Å—Ç—É–ø–∞.

## –®—Ç–∞ —Å–ª–µ–¥–∏

- [5.13 Model Context Protocol (MCP) Integration with Azure AI Foundry](../mcp-foundry-agent-integration/README.md)

**–û–¥—Ä–∏—Ü–∞—ö–µ –æ–¥ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç–∏**:  
–û–≤–∞—ò –¥–æ–∫—É–º–µ–Ω—Ç —ò–µ –ø—Ä–µ–≤–µ–¥–µ–Ω –∫–æ—Ä–∏—à—õ–µ—ö–µ–º AI –ø—Ä–µ–≤–æ–¥–∏–ª–∞—á–∫–µ —É—Å–ª—É–≥–µ [Co-op Translator](https://github.com/Azure/co-op-translator). –ò–∞–∫–æ —Å–µ —Ç—Ä—É–¥–∏–º–æ –¥–∞ –ø—Ä–µ–≤–æ–¥ –±—É–¥–µ —Ç–∞—á–∞–Ω, –º–æ–ª–∏–º–æ –≤–∞—Å –¥–∞ –∏–º–∞—Ç–µ —É –≤–∏–¥—É –¥–∞ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –ø—Ä–µ–≤–æ–¥–∏ –º–æ–≥—É —Å–∞–¥—Ä–∂–∞—Ç–∏ –≥—Ä–µ—à–∫–µ –∏–ª–∏ –Ω–µ—Ç–∞—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ —ö–µ–≥–æ–≤–æ–º –∏–∑–≤–æ—Ä–Ω–æ–º —ò–µ–∑–∏–∫—É —Ç—Ä–µ–±–∞ —Å–º–∞—Ç—Ä–∞—Ç–∏ –∞—É—Ç–æ—Ä–∏—Ç–µ—Ç–Ω–∏–º –∏–∑–≤–æ—Ä–æ–º. –ó–∞ –∫—Ä–∏—Ç–∏—á–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –ø—Ä–µ–ø–æ—Ä—É—á—É—ò–µ —Å–µ –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–Ω–∏ —ô—É–¥—Å–∫–∏ –ø—Ä–µ–≤–æ–¥. –ù–∏—Å–º–æ –æ–¥–≥–æ–≤–æ—Ä–Ω–∏ –∑–∞ –±–∏–ª–æ –∫–∞–∫–≤–∞ –Ω–µ—Å–ø–æ—Ä–∞–∑—É–º–∞ –∏–ª–∏ –ø–æ–≥—Ä–µ—à–Ω–∞ —Ç—É–º–∞—á–µ—ö–∞ –∫–æ—ò–∞ –ø—Ä–æ–∏–∑–∏–ª–∞–∑–µ –∏–∑ –∫–æ—Ä–∏—à—õ–µ—ö–∞ –æ–≤–æ–≥ –ø—Ä–µ–≤–æ–¥–∞.