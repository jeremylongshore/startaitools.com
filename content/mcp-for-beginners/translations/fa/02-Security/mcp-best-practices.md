<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "b2b9e15e78b9d9a2b3ff3e8fd7d1f434",
  "translation_date": "2025-08-18T12:06:11+00:00",
  "source_file": "02-Security/mcp-best-practices.md",
  "language_code": "fa"
}
-->
# بهترین روش‌های امنیتی MCP 2025

این راهنمای جامع، بهترین روش‌های امنیتی ضروری برای پیاده‌سازی سیستم‌های پروتکل زمینه مدل (MCP) را بر اساس **مشخصات MCP 2025-06-18** و استانداردهای فعلی صنعت ارائه می‌دهد. این روش‌ها به نگرانی‌های امنیتی سنتی و تهدیدات خاص هوش مصنوعی که در استقرار MCP وجود دارند، می‌پردازند.

## الزامات امنیتی حیاتی

### کنترل‌های امنیتی اجباری (الزامات MUST)

1. **اعتبارسنجی توکن**: سرورهای MCP **نباید** هیچ توکنی را که به‌طور صریح برای خود سرور MCP صادر نشده است، بپذیرند.
2. **تأیید مجوز**: سرورهای MCP که مجوزدهی را پیاده‌سازی می‌کنند **باید** تمام درخواست‌های ورودی را تأیید کنند و **نباید** از جلسات برای احراز هویت استفاده کنند.
3. **رضایت کاربر**: سرورهای پروکسی MCP که از شناسه‌های ثابت مشتری استفاده می‌کنند **باید** رضایت صریح کاربر را برای هر مشتری ثبت‌شده پویا دریافت کنند.
4. **شناسه‌های جلسه امن**: سرورهای MCP **باید** از شناسه‌های جلسه‌ای که به‌صورت رمزنگاری امن و غیرقابل پیش‌بینی تولید شده‌اند، استفاده کنند.

## روش‌های اصلی امنیتی

### 1. اعتبارسنجی و پاک‌سازی ورودی
- **اعتبارسنجی جامع ورودی**: تمام ورودی‌ها را اعتبارسنجی و پاک‌سازی کنید تا از حملات تزریقی، مشکلات نماینده گیج‌شده و آسیب‌پذیری‌های تزریق درخواست جلوگیری شود.
- **اجرای طرح‌واره پارامتر**: اعتبارسنجی طرح‌واره JSON سختگیرانه را برای تمام پارامترهای ابزار و ورودی‌های API پیاده‌سازی کنید.
- **فیلتر کردن محتوا**: از Microsoft Prompt Shields و Azure Content Safety برای فیلتر کردن محتوای مخرب در درخواست‌ها و پاسخ‌ها استفاده کنید.
- **پاک‌سازی خروجی**: تمام خروجی‌های مدل را قبل از ارائه به کاربران یا سیستم‌های پایین‌دستی اعتبارسنجی و پاک‌سازی کنید.

### 2. احراز هویت و مجوزدهی عالی  
- **ارائه‌دهندگان هویت خارجی**: احراز هویت را به ارائه‌دهندگان هویت معتبر (Microsoft Entra ID، ارائه‌دهندگان OAuth 2.1) واگذار کنید و از پیاده‌سازی احراز هویت سفارشی خودداری کنید.
- **مجوزهای دقیق**: مجوزهای دقیق و ابزارمحور را با رعایت اصل حداقل دسترسی پیاده‌سازی کنید.
- **مدیریت چرخه عمر توکن**: از توکن‌های دسترسی کوتاه‌مدت با چرخش امن و اعتبارسنجی مخاطب مناسب استفاده کنید.
- **احراز هویت چندعاملی**: MFA را برای تمام دسترسی‌های مدیریتی و عملیات حساس الزامی کنید.

### 3. پروتکل‌های ارتباطی امن
- **امنیت لایه انتقال**: از HTTPS/TLS 1.3 برای تمام ارتباطات MCP با اعتبارسنجی مناسب گواهی استفاده کنید.
- **رمزنگاری انتها به انتها**: لایه‌های رمزنگاری اضافی را برای داده‌های بسیار حساس در حال انتقال و ذخیره پیاده‌سازی کنید.
- **مدیریت گواهی**: چرخه عمر گواهی را با فرآیندهای تمدید خودکار به‌درستی مدیریت کنید.
- **اجرای نسخه پروتکل**: از نسخه فعلی پروتکل MCP (2025-06-18) با مذاکره نسخه مناسب استفاده کنید.

### 4. محدودیت نرخ پیشرفته و حفاظت از منابع
- **محدودیت نرخ چندلایه**: محدودیت نرخ را در سطح کاربر، جلسه، ابزار و منابع پیاده‌سازی کنید تا از سوءاستفاده جلوگیری شود.
- **محدودیت نرخ تطبیقی**: از محدودیت نرخ مبتنی بر یادگیری ماشین که به الگوهای استفاده و شاخص‌های تهدید تطبیق می‌یابد، استفاده کنید.
- **مدیریت سهمیه منابع**: محدودیت‌های مناسب برای منابع محاسباتی، استفاده از حافظه و زمان اجرا تعیین کنید.
- **حفاظت از DDoS**: سیستم‌های جامع حفاظت از DDoS و تحلیل ترافیک را مستقر کنید.

### 5. ثبت و نظارت جامع
- **ثبت حسابرسی ساختاریافته**: ثبت‌های دقیق و قابل جستجو برای تمام عملیات MCP، اجراهای ابزار و رویدادهای امنیتی پیاده‌سازی کنید.
- **نظارت امنیتی بلادرنگ**: سیستم‌های SIEM با تشخیص ناهنجاری مبتنی بر هوش مصنوعی را برای بارهای کاری MCP مستقر کنید.
- **ثبت مطابق با حریم خصوصی**: رویدادهای امنیتی را با رعایت الزامات و مقررات حریم خصوصی ثبت کنید.
- **ادغام پاسخ به حادثه**: سیستم‌های ثبت را به جریان‌های کاری پاسخ به حادثه خودکار متصل کنید.

### 6. روش‌های ذخیره‌سازی امن پیشرفته
- **ماژول‌های امنیتی سخت‌افزاری**: از ذخیره کلید پشتیبانی‌شده توسط HSM (Azure Key Vault، AWS CloudHSM) برای عملیات رمزنگاری حیاتی استفاده کنید.
- **مدیریت کلید رمزنگاری**: چرخش مناسب کلید، جداسازی و کنترل‌های دسترسی برای کلیدهای رمزنگاری را پیاده‌سازی کنید.
- **مدیریت اسرار**: تمام کلیدهای API، توکن‌ها و اعتبارنامه‌ها را در سیستم‌های مدیریت اسرار اختصاصی ذخیره کنید.
- **طبقه‌بندی داده‌ها**: داده‌ها را بر اساس سطح حساسیت طبقه‌بندی کرده و اقدامات حفاظتی مناسب اعمال کنید.

### 7. مدیریت توکن پیشرفته
- **جلوگیری از عبور توکن**: الگوهای عبور توکن که کنترل‌های امنیتی را دور می‌زنند، به‌طور صریح ممنوع کنید.
- **اعتبارسنجی مخاطب**: همیشه ادعاهای مخاطب توکن را بررسی کنید تا با هویت سرور MCP موردنظر مطابقت داشته باشد.
- **مجوزدهی مبتنی بر ادعا**: مجوزدهی دقیق بر اساس ادعاهای توکن و ویژگی‌های کاربر پیاده‌سازی کنید.
- **اتصال توکن**: توکن‌ها را به جلسات، کاربران یا دستگاه‌های خاص در صورت لزوم متصل کنید.

### 8. مدیریت جلسه امن
- **شناسه‌های جلسه رمزنگاری‌شده**: شناسه‌های جلسه را با استفاده از تولیدکننده‌های عدد تصادفی امن رمزنگاری‌شده (نه توالی‌های قابل پیش‌بینی) تولید کنید.
- **اتصال خاص کاربر**: شناسه‌های جلسه را به اطلاعات خاص کاربر با استفاده از فرمت‌های امن مانند `<user_id>:<session_id>` متصل کنید.
- **کنترل‌های چرخه عمر جلسه**: مکانیسم‌های انقضا، چرخش و ابطال مناسب جلسه را پیاده‌سازی کنید.
- **هدرهای امنیتی جلسه**: از هدرهای امنیتی HTTP مناسب برای حفاظت از جلسه استفاده کنید.

### 9. کنترل‌های امنیتی خاص هوش مصنوعی
- **دفاع در برابر تزریق درخواست**: Microsoft Prompt Shields را با تکنیک‌های برجسته‌سازی، جداکننده‌ها و علامت‌گذاری داده‌ها مستقر کنید.
- **جلوگیری از مسمومیت ابزار**: متاداده‌های ابزار را اعتبارسنجی کنید، تغییرات پویا را نظارت کنید و یکپارچگی ابزار را تأیید کنید.
- **اعتبارسنجی خروجی مدل**: خروجی‌های مدل را برای نشت احتمالی داده، محتوای مضر یا نقض سیاست‌های امنیتی اسکن کنید.
- **حفاظت از پنجره زمینه**: کنترل‌هایی را برای جلوگیری از مسمومیت پنجره زمینه و حملات دستکاری پیاده‌سازی کنید.

### 10. امنیت اجرای ابزار
- **محیط‌های ایزوله اجرا**: اجراهای ابزار را در محیط‌های کانتینری و ایزوله با محدودیت‌های منابع اجرا کنید.
- **جداسازی امتیازات**: ابزارها را با حداقل امتیازات موردنیاز و حساب‌های خدمات جداگانه اجرا کنید.
- **ایزوله‌سازی شبکه**: تقسیم‌بندی شبکه را برای محیط‌های اجرای ابزار پیاده‌سازی کنید.
- **نظارت بر اجرا**: اجرای ابزار را برای رفتار غیرعادی، استفاده از منابع و نقض‌های امنیتی نظارت کنید.

### 11. اعتبارسنجی امنیتی مداوم
- **آزمایش امنیت خودکار**: آزمایش امنیت را در خطوط لوله CI/CD با ابزارهایی مانند GitHub Advanced Security ادغام کنید.
- **مدیریت آسیب‌پذیری**: تمام وابستگی‌ها، از جمله مدل‌های هوش مصنوعی و خدمات خارجی را به‌طور منظم اسکن کنید.
- **آزمایش نفوذ**: ارزیابی‌های امنیتی منظم را که به‌طور خاص استقرارهای MCP را هدف قرار می‌دهند، انجام دهید.
- **بررسی‌های کد امنیتی**: بررسی‌های امنیتی اجباری را برای تمام تغییرات کد مرتبط با MCP پیاده‌سازی کنید.

### 12. امنیت زنجیره تأمین برای هوش مصنوعی
- **تأیید اجزا**: منشأ، یکپارچگی و امنیت تمام اجزای هوش مصنوعی (مدل‌ها، جاسازی‌ها، APIها) را تأیید کنید.
- **مدیریت وابستگی‌ها**: موجودی‌های فعلی تمام نرم‌افزارها و وابستگی‌های هوش مصنوعی را با ردیابی آسیب‌پذیری حفظ کنید.
- **مخازن قابل اعتماد**: از منابع تأییدشده و قابل اعتماد برای تمام مدل‌ها، کتابخانه‌ها و ابزارهای هوش مصنوعی استفاده کنید.
- **نظارت بر زنجیره تأمین**: به‌طور مداوم برای مصالحه در ارائه‌دهندگان خدمات هوش مصنوعی و مخازن مدل نظارت کنید.

## الگوهای امنیتی پیشرفته

### معماری اعتماد صفر برای MCP
- **هرگز اعتماد نکنید، همیشه تأیید کنید**: تأیید مداوم برای تمام شرکت‌کنندگان MCP پیاده‌سازی کنید.
- **ریزتقسیم‌بندی**: اجزای MCP را با کنترل‌های دقیق شبکه و هویت ایزوله کنید.
- **دسترسی شرطی**: کنترل‌های دسترسی مبتنی بر ریسک را که به زمینه و رفتار تطبیق می‌یابند، پیاده‌سازی کنید.
- **ارزیابی مداوم ریسک**: وضعیت امنیتی را به‌طور پویا بر اساس شاخص‌های تهدید فعلی ارزیابی کنید.

### پیاده‌سازی هوش مصنوعی حفظ حریم خصوصی
- **حداقل‌سازی داده‌ها**: فقط حداقل داده‌های لازم را برای هر عملیات MCP افشا کنید.
- **حریم خصوصی تفاضلی**: تکنیک‌های حفظ حریم خصوصی را برای پردازش داده‌های حساس پیاده‌سازی کنید.
- **رمزنگاری همومورفیک**: از تکنیک‌های رمزنگاری پیشرفته برای محاسبات امن بر روی داده‌های رمزنگاری‌شده استفاده کنید.
- **یادگیری فدرال**: رویکردهای یادگیری توزیع‌شده را که محلی بودن داده‌ها و حریم خصوصی را حفظ می‌کنند، پیاده‌سازی کنید.

### پاسخ به حادثه برای سیستم‌های هوش مصنوعی
- **رویه‌های حادثه خاص هوش مصنوعی**: رویه‌های پاسخ به حادثه را که برای تهدیدات خاص هوش مصنوعی و MCP طراحی شده‌اند، توسعه دهید.
- **پاسخ خودکار**: مهار و اصلاح خودکار برای حوادث امنیتی رایج هوش مصنوعی پیاده‌سازی کنید.
- **قابلیت‌های قانونی**: آمادگی قانونی برای مصالحه‌های سیستم هوش مصنوعی و نقض داده‌ها حفظ کنید.
- **رویه‌های بازیابی**: رویه‌هایی برای بازیابی از مسمومیت مدل هوش مصنوعی، حملات تزریق درخواست و مصالحه‌های خدمات ایجاد کنید.

## منابع و استانداردهای پیاده‌سازی

### مستندات رسمی MCP
- [مشخصات MCP 2025-06-18](https://spec.modelcontextprotocol.io/specification/2025-06-18/) - مشخصات فعلی پروتکل MCP
- [بهترین روش‌های امنیتی MCP](https://modelcontextprotocol.io/specification/2025-06-18/basic/security_best_practices) - راهنمای رسمی امنیت
- [مشخصات مجوزدهی MCP](https://modelcontextprotocol.io/specification/2025-06-18/basic/authorization) - الگوهای احراز هویت و مجوزدهی
- [امنیت انتقال MCP](https://modelcontextprotocol.io/specification/2025-06-18/transports/) - الزامات امنیت لایه انتقال

### راه‌حل‌های امنیتی مایکروسافت
- [Microsoft Prompt Shields](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection) - حفاظت پیشرفته در برابر تزریق درخواست
- [Azure Content Safety](https://learn.microsoft.com/azure/ai-services/content-safety/) - فیلتر جامع محتوای هوش مصنوعی
- [Microsoft Entra ID](https://learn.microsoft.com/entra/identity-platform/v2-oauth2-auth-code-flow) - مدیریت هویت و دسترسی سازمانی
- [Azure Key Vault](https://learn.microsoft.com/azure/key-vault/general/basic-concepts) - مدیریت امن اسرار و اعتبارنامه‌ها
- [GitHub Advanced Security](https://github.com/security/advanced-security) - اسکن امنیتی زنجیره تأمین و کد

### استانداردها و چارچوب‌های امنیتی
- [بهترین روش‌های امنیتی OAuth 2.1](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics) - راهنمای امنیتی فعلی OAuth
- [OWASP Top 10](https://owasp.org/www-project-top-ten/) - خطرات امنیتی برنامه‌های وب
- [OWASP Top 10 برای LLMها](https://genai.owasp.org/download/43299/?tmstv=1731900559) - خطرات امنیتی خاص هوش مصنوعی
- [چارچوب مدیریت ریسک هوش مصنوعی NIST](https://www.nist.gov/itl/ai-risk-management-framework) - مدیریت جامع ریسک هوش مصنوعی
- [ISO 27001:2022](https://www.iso.org/standard/27001) - سیستم‌های مدیریت امنیت اطلاعات

### راهنماها و آموزش‌های پیاده‌سازی
- [مدیریت API Azure به‌عنوان دروازه احراز هویت MCP](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690) - الگوهای احراز هویت سازمانی
- [Microsoft Entra ID با سرورهای MCP](https://den.dev/blog/mcp-server-auth-entra-id-session/) - ادغام ارائه‌دهنده هویت
- [پیاده‌سازی ذخیره امن توکن](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2) - بهترین روش‌های مدیریت توکن
- [رمزنگاری انتها به انتها برای هوش مصنوعی](https://learn.microsoft.com/azure/architecture/example-scenario/confidential/end-to-end-encryption) - الگوهای رمزنگاری پیشرفته

### منابع امنیتی پیشرفته
- [چرخه عمر توسعه امنیتی مایکروسافت](https://www.microsoft.com/sdl) - روش‌های توسعه امن
- [راهنمای تیم قرمز هوش مصنوعی](https://learn.microsoft.com/security/ai-red-team/) - آزمایش امنیتی خاص هوش مصنوعی
- [مدل‌سازی تهدید برای سیستم‌های هوش مصنوعی](https://learn.microsoft.com/security/adoption/approach/threats-ai) - روش‌شناسی مدل‌سازی تهدید هوش مصنوعی
- [مهندسی حریم خصوصی برای هوش مصنوعی](https://www.microsoft.com/security/blog/2021/07/13/microsofts-pet-project-privacy-enhancing-technologies-in-action/) - تکنیک‌های حفظ حریم خصوصی هوش مصنوعی

### انطباق و حاکمیت
- [انطباق GDPR برای هوش مصنوعی](https://learn.microsoft.com/compliance/regulatory/gdpr-data-protection-impact-assessments) - انطباق حریم خصوصی در سیستم‌های هوش مصنوعی
- [چارچوب حاکمیت هوش مصنوعی](https://learn.microsoft.com/azure/architecture/guide/responsible-ai/responsible-ai-overview) - پیاده‌سازی هوش مصنوعی مسئولانه
- [SOC 2 برای خدمات هوش مصنوعی](https://learn.microsoft.com/compliance/regulatory/offering-soc) - کنترل‌های امنیتی برای ارائه‌دهندگان خدمات هوش مصنوعی
- [انطباق HIPAA برای هوش مصنوعی](https://learn.microsoft.com/compliance/regulatory/offering-hipaa-hitech) - الزامات انطباق هوش مصنوعی در حوزه سلامت

### DevSecOps و خودکارسازی
- [خط لوله DevSecOps برای هوش مصنوعی](https://learn.microsoft.com/azure/devops/migrate/security-validation-cicd-pipeline) - خطوط لوله توسعه امن هوش مصنوعی
- [آزمایش امنیت خودکار](https://learn.microsoft.com/security/engineering/devsecops) - اعتبارسنجی امنیتی مداوم
- [امنیت زیرساخت به‌عنوان کد](https://learn.microsoft.com/security/engineering/infrastructure-security) - استقرار امن زیرساخت
- [امنیت کانتینر برای هوش مصنوعی](https://learn.microsoft.com/azure/container-instances/container-instances-image-security) - امنیت کانتینری بارهای کاری هوش مصنوعی

### نظارت و پاسخ به حادثه  
- [Azure Monitor برای بارهای کاری هوش مصنوعی](https://learn.microsoft.com/azure/azure-monitor/overview) - راه‌حل‌های نظارت جامع
- [پاسخ به حادثه امنیتی هوش مصنوعی](https://learn.microsoft.com/security/compass/incident-response-playbooks) - رویه‌های حادثه خاص هوش مصنوعی
- [SIEM برای سیستم‌های هوش مصنوعی](https://learn.microsoft.com/azure
- **توسعه ابزار**: توسعه و اشتراک‌گذاری ابزارها و کتابخانه‌های امنیتی برای اکوسیستم MCP

---

*این سند بهترین شیوه‌های امنیتی MCP را تا تاریخ ۱۸ آگوست ۲۰۲۵ بر اساس مشخصات MCP 2025-06-18 منعکس می‌کند. شیوه‌های امنیتی باید به طور منظم بررسی و به‌روزرسانی شوند، زیرا پروتکل و چشم‌انداز تهدیدها در حال تغییر هستند.*

**سلب مسئولیت**:  
این سند با استفاده از سرویس ترجمه هوش مصنوعی [Co-op Translator](https://github.com/Azure/co-op-translator) ترجمه شده است. در حالی که ما برای دقت تلاش می‌کنیم، لطفاً توجه داشته باشید که ترجمه‌های خودکار ممکن است شامل خطاها یا نادقتی‌هایی باشند. سند اصلی به زبان اصلی آن باید به عنوان منبع معتبر در نظر گرفته شود. برای اطلاعات حساس، ترجمه حرفه‌ای انسانی توصیه می‌شود. ما هیچ مسئولیتی در قبال سوءتفاهم‌ها یا تفسیرهای نادرست ناشی از استفاده از این ترجمه نداریم.